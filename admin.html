<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <title>SiaMatch Admin</title>
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
  />
  <style>
    :root {
      --bg: #020617;
      --card-bg: #0f172a;
      --accent: #22c55e;
      --accent-dark: #16a34a;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --danger: #ef4444;
      --warning: #f59e0b;
      --info: #3b82f6;
      --pending: #f59e0b;
      --boost: #f59e0b;
      --reports: #ec4899;
      --invite: #3b82f6;
      --share: #8b5cf6;
    }
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      min-height: 100vh;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, sans-serif;
      background: radial-gradient(circle at top, #0f172a 0, #020617 60%, #000 100%);
      color: var(--text);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 16px;
    }
    #admin-root {
      width: 100%;
      max-width: 900px;
    }
    .card {
      background: rgba(15, 23, 42, 0.96);
      border-radius: 18px;
      padding: 20px 18px 22px;
      box-shadow: 0 18px 45px rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.2);
    }
    .logo {
      font-size: 32px;
      text-align: center;
      margin-bottom: 4px;
    }
    .title {
      text-align: center;
      font-size: 20px;
      font-weight: 600;
      margin-bottom: 4px;
    }
    .subtitle {
      text-align: center;
      font-size: 13px;
      color: var(--muted);
      margin-bottom: 18px;
    }
    .field {
      margin-bottom: 14px;
    }
    label {
      display: block;
      font-size: 13px;
      margin-bottom: 4px;
      color: var(--muted);
    }
    input[type="password"],
    input[type="text"],
    input[type="number"],
    textarea {
      width: 100%;
      padding: 9px 10px;
      border-radius: 10px;
      border: 1px solid #1f2937;
      background: #020617;
      color: var(--text);
      font-size: 14px;
      outline: none;
    }
    input:focus,
    textarea:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(34, 197, 94, 0.5);
    }

    /* –ö–Ω–æ–ø–∫–∏ */
    .primary {
      border: none;
      padding: 10px 16px;
      border-radius: 999px;
      background: linear-gradient(135deg, var(--accent), var(--accent-dark));
      color: white;
      font-size: 15px;
      cursor: pointer;
      transition: transform 0.08s ease, box-shadow 0.08s ease;
    }
    .primary:active {
      transform: translateY(1px);
      box-shadow: 0 4px 12px rgba(34, 197, 94, 0.4);
    }
    #login-btn {
      width: 100%;
      margin-top: 6px;
    }

    .error {
      margin-top: 6px;
      font-size: 12px;
      color: var(--danger);
      min-height: 16px;
    }
    .hint {
      font-size: 12px;
      color: var(--muted);
      margin-top: 4px;
    }
    .hidden {
      display: none !important;
    }

    /* –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å */
    #admin-panel-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 18px;
      gap: 8px;
    }
    #admin-panel-header .left {
      display: flex;
      flex-direction: column;
    }
    #admin-panel-header h2 {
      font-size: 18px;
      margin: 0 0 2px;
    }
    #admin-panel-header span {
      font-size: 12px;
      color: var(--muted);
    }
    #logout-btn {
      border: 1px solid rgba(148, 163, 184, 0.5);
      background: transparent;
      color: var(--muted);
      border-radius: 999px;
      padding: 6px 12px;
      font-size: 12px;
      cursor: pointer;
    }

    /* –¢–∞–±—ã */
    #admin-tabs {
      display: flex;
      gap: 6px;
      margin-bottom: 18px;
      flex-wrap: wrap;
    }
    .tab-btn {
      border: none;
      background: rgba(148, 163, 184, 0.1);
      color: var(--muted);
      border-radius: 10px;
      padding: 8px 14px;
      font-size: 13px;
      cursor: pointer;
      transition: all 0.2s ease;
      flex: 1;
      min-width: 120px;
      text-align: center;
    }
    .tab-btn:hover {
      background: rgba(148, 163, 184, 0.2);
    }
    .tab-btn.active {
      color: white;
      font-weight: 500;
    }
    .tab-btn[data-tab="all"].active {
      background: linear-gradient(135deg, var(--accent), var(--accent-dark));
    }
    .tab-btn[data-tab="new"].active {
      background: linear-gradient(135deg, var(--info), #2563eb);
    }
    .tab-btn[data-tab="verification"].active {
      background: linear-gradient(135deg, var(--warning), #d97706);
    }
    .tab-btn[data-tab="blocked"].active {
      background: linear-gradient(135deg, var(--danger), #dc2626);
    }
    .tab-btn[data-tab="reports"].active {
      background: linear-gradient(135deg, var(--reports), #db2777);
    }
    .tab-btn[data-tab="search"].active {
      background: linear-gradient(135deg, #8b5cf6, #7c3aed);
    }
    .tab-btn[data-tab="bonuses"].active {
      background: linear-gradient(135deg, var(--invite), #1d4ed8);
    }

    /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 12px;
      margin-bottom: 20px;
    }
    .stat-card {
      background: rgba(2, 6, 23, 0.7);
      border-radius: 12px;
      padding: 14px;
      border: 1px solid rgba(148, 163, 184, 0.1);
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }
    .stat-number {
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 4px;
    }
    .stat-number.total { color: var(--accent); }
    .stat-number.new { color: var(--info); }
    .stat-number.active { color: #10b981; }
    .stat-number.blocked { color: var(--danger); }
    .stat-number.pending { color: var(--pending); }
    .stat-number.verified { color: #10b981; }
    .stat-number.boosted { color: var(--boost); }
    .stat-number.reports { color: var(--reports); }
    .stat-number.invites { color: var(--invite); }
    .stat-number.shares { color: var(--share); }
    .stat-number.bonus-swipes { color: #10b981; }
    .stat-label {
      font-size: 12px;
      color: var(--muted);
    }

    /* –ü–æ–∏—Å–∫–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ */
    #search-row {
      display: flex;
      gap: 8px;
      margin-bottom: 16px;
      align-items: center;
    }
    #search-input {
      flex: 1;
    }
    #search-btn {
      width: auto;
      padding: 8px 16px;
      font-size: 14px;
      white-space: nowrap;
    }

    /* –§–∏–ª—å—Ç—Ä—ã */
    #filters-row {
      display: none;
      gap: 8px;
      margin-bottom: 16px;
      flex-wrap: wrap;
    }
    .filter-select {
      padding: 8px 12px;
      border-radius: 8px;
      border: 1px solid #1f2937;
      background: #020617;
      color: var(--text);
      font-size: 13px;
      min-width: 120px;
    }

    /* –†–µ–∑—É–ª—å—Ç–∞—Ç—ã */
    #results-info {
      font-size: 13px;
      color: var(--muted);
      margin-bottom: 12px;
      padding: 8px 0;
      border-bottom: 1px solid rgba(148, 163, 184, 0.1);
    }
    #users-list {
      list-style: none;
      padding: 0;
      margin: 0;
      max-height: 400px;
      overflow-y: auto;
    }
    .user-item {
      border-radius: 10px;
      padding: 12px 14px;
      border: 1px solid #1f2937;
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
      background: #020617;
      font-size: 13px;
    }
    .user-item.blocked {
      border-left: 4px solid var(--danger);
      opacity: 0.8;
    }
    .user-item.new {
      border-left: 4px solid var(--info);
    }
    .user-item.pending {
      border-left: 4px solid var(--pending);
    }
    .user-item.verified {
      border-left: 4px solid #10b981;
    }
    .user-item.boosted {
      border-left: 4px solid var(--boost);
    }
    .user-item.report-item {
      border-left: 4px solid var(--reports);
    }
    .user-item.bonus-item {
      border-left: 4px solid var(--invite);
    }
    .user-main {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }
    .user-name {
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .verification-badge {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 2px 8px;
      border-radius: 10px;
      font-size: 11px;
      font-weight: 600;
    }
    .verification-badge.pending {
      background: rgba(245, 158, 11, 0.2);
      color: var(--pending);
    }
    .verification-badge.verified {
      background: rgba(16, 185, 129, 0.2);
      color: #10b981;
    }
    .verification-badge.not-verified {
      background: rgba(107, 114, 128, 0.2);
      color: var(--muted);
    }
    .verification-badge.rejected {
      background: rgba(239, 68, 68, 0.2);
      color: var(--danger);
    }
    .boost-badge {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 2px 8px;
      border-radius: 10px;
      font-size: 11px;
      font-weight: 600;
      background: rgba(245, 158, 11, 0.2);
      color: var(--boost);
    }
    .report-badge {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 2px 8px;
      border-radius: 10px;
      font-size: 11px;
      font-weight: 600;
      background: rgba(236, 72, 153, 0.2);
      color: var(--reports);
    }
    .bonus-badge {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 2px 8px;
      border-radius: 10px;
      font-size: 11px;
      font-weight: 600;
      background: rgba(59, 130, 246, 0.2);
      color: var(--invite);
    }
    .user-meta {
      color: var(--muted);
      font-size: 12px;
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }
    .user-actions {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 6px;
      min-width: 140px;
    }
    .link-btn {
      border: none;
      background: none;
      color: var(--accent);
      font-size: 12px;
      cursor: pointer;
      padding: 0;
      text-align: right;
    }
    .block-btn {
      border: none;
      background: none;
      color: var(--danger);
      font-size: 12px;
      cursor: pointer;
      padding: 0;
      text-align: right;
    }
    .unblock-btn {
      border: none;
      background: none;
      color: var(--warning);
      font-size: 12px;
      cursor: pointer;
      padding: 0;
      text-align: right;
    }
    .verify-btn {
      border: none;
      background: none;
      color: #10b981;
      font-size: 12px;
      cursor: pointer;
      padding: 0;
      text-align: right;
    }
    .reject-btn {
      border: none;
      background: none;
      color: var(--danger);
      font-size: 12px;
      cursor: pointer;
      padding: 0;
      text-align: right;
    }
    .boost-btn-admin {
      border: none;
      background: none;
      color: var(--boost);
      font-size: 12px;
      cursor: pointer;
      padding: 0;
      text-align: right;
    }
    .swipes-btn-admin {
      border: none;
      background: none;
      color: #10b981;
      font-size: 12px;
      cursor: pointer;
      padding: 0;
      text-align: right;
    }
    .report-details-btn {
      border: none;
      background: none;
      color: var(--reports);
      font-size: 12px;
      cursor: pointer;
      padding: 0;
      text-align: right;
    }
    .bonus-btn-admin {
      border: none;
      background: none;
      color: var(--invite);
      font-size: 12px;
      cursor: pointer;
      padding: 0;
      text-align: right;
    }
    .user-actions-row {
      display: flex;
      gap: 10px;
    }

    /* –ë–∞–Ω–Ω–µ—Ä—ã —Ä–∞–∑–¥–µ–ª–æ–≤ */
    .section-banner {
      padding: 16px;
      border-radius: 12px;
      margin-bottom: 20px;
      border: 1px solid rgba(148, 163, 184, 0.2);
    }
    .section-banner.all {
      background: linear-gradient(135deg, rgba(34, 197, 94, 0.1), rgba(16, 185, 129, 0.05));
      border-color: rgba(34, 197, 94, 0.2);
    }
    .section-banner.new {
      background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(37, 99, 235, 0.05));
      border-color: rgba(59, 130, 246, 0.2);
    }
    .section-banner.blocked {
      background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(220, 38, 38, 0.05));
      border-color: rgba(239, 68, 68, 0.2);
    }
    .section-banner.search {
      background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(37, 99, 235, 0.05));
      border-color: rgba(59, 130, 246, 0.2);
    }
    .section-banner.verification {
      background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(217, 119, 6, 0.05));
      border-color: rgba(245, 158, 11, 0.2);
    }
    .section-banner.reports {
      background: linear-gradient(135deg, rgba(236, 72, 153, 0.1), rgba(219, 39, 119, 0.05));
      border-color: rgba(236, 72, 153, 0.2);
    }
    .section-banner.bonuses {
      background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(29, 78, 216, 0.05));
      border-color: rgba(59, 130, 246, 0.2);
    }
    .section-banner h3 {
      margin: 0 0 6px;
      font-size: 16px;
    }
    .section-banner p {
      margin: 0;
      font-size: 13px;
      color: var(--muted);
    }

    /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(2, 6, 23, 0.9);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      padding: 16px;
    }
    .modal {
      background: var(--card-bg);
      border-radius: 16px;
      padding: 20px;
      max-width: 800px;
      width: 100%;
      max-height: 80vh;
      overflow-y: auto;
      border: 1px solid rgba(148, 163, 184, 0.2);
    }
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }
    .modal-header h3 {
      margin: 0;
      font-size: 18px;
    }
    .close-btn {
      background: none;
      border: none;
      color: var(--muted);
      font-size: 20px;
      cursor: pointer;
    }
    
    /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–µ—Ç–∞–ª–µ–π –∂–∞–ª–æ–±—ã */
    .report-details-content {
      max-height: 60vh;
      overflow-y: auto;
    }
    .report-section {
      margin-bottom: 20px;
      padding: 16px;
      background: rgba(2, 6, 23, 0.5);
      border-radius: 12px;
      border: 1px solid rgba(148, 163, 184, 0.1);
    }
    .report-section-title {
      font-size: 15px;
      font-weight: 600;
      color: var(--text);
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .report-user-info {
      display: flex;
      gap: 16px;
      margin-bottom: 15px;
      flex-wrap: wrap;
    }
    .report-user-card {
      flex: 1;
      min-width: 200px;
      padding: 12px;
      background: rgba(2, 6, 23, 0.7);
      border-radius: 10px;
      border: 1px solid rgba(148, 163, 184, 0.1);
    }
    .report-user-name {
      font-weight: 600;
      margin-bottom: 5px;
    }
    .report-user-details {
      font-size: 12px;
      color: var(--muted);
      line-height: 1.4;
    }
    .chat-messages-list {
      max-height: 300px;
      overflow-y: auto;
      padding: 12px;
      background: rgba(2, 6, 23, 0.7);
      border-radius: 10px;
      border: 1px solid rgba(148, 163, 184, 0.1);
    }
    .chat-message {
      padding: 8px 12px;
      margin-bottom: 8px;
      border-radius: 8px;
      font-size: 13px;
      line-height: 1.4;
    }
    .chat-message.reporter {
      background: rgba(34, 197, 94, 0.1);
      border-left: 3px solid var(--accent);
    }
    .chat-message.reported {
      background: rgba(239, 68, 68, 0.1);
      border-left: 3px solid var(--danger);
    }
    .chat-message-system {
      background: rgba(148, 163, 184, 0.1);
      border-left: 3px solid var(--muted);
      text-align: center;
      font-size: 11px;
      color: var(--muted);
    }
    .message-sender {
      font-weight: 600;
      margin-bottom: 4px;
    }
    .message-text {
      margin-bottom: 4px;
    }
    .message-time {
      font-size: 10px;
      color: var(--muted);
      text-align: right;
    }
    .modal-actions {
      display: flex;
      gap: 12px;
      margin-top: 20px;
    }
    .modal-actions .primary {
      flex: 1;
    }
    .danger-btn {
      background: linear-gradient(135deg, var(--danger), #dc2626) !important;
    }
    .warning-btn {
      background: linear-gradient(135deg, var(--warning), #d97706) !important;
    }
    .reports-btn {
      background: linear-gradient(135deg, var(--reports), #db2777) !important;
    }
    .invite-btn {
      background: linear-gradient(135deg, var(--invite), #1d4ed8) !important;
    }
    .share-btn {
      background: linear-gradient(135deg, var(--share), #7c3aed) !important;
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–≤–∞–π–ø–æ–≤ */
    .swipe-amount-btn {
      padding: 8px 12px;
      background: rgba(59, 130, 246, 0.1);
      border: 1px solid rgba(59, 130, 246, 0.3);
      color: var(--info);
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      transition: all 0.2s;
      flex: 1;
      min-width: 60px;
    }
    
    .swipe-amount-btn:hover {
      background: rgba(59, 130, 246, 0.2);
      border-color: var(--info);
    }
    
    .swipe-amount-btn.active {
      background: var(--info);
      color: white;
      border-color: var(--info);
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –±—É—Å—Ç–∞ –∏ —Å–≤–∞–π–ø–æ–≤ */
    .modal-actions .boost-btn {
      background: linear-gradient(135deg, var(--boost), #d97706) !important;
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è –±–æ–Ω—É—Å–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π */
    .bonus-record {
      background: rgba(2, 6, 23, 0.7);
      border-radius: 10px;
      padding: 12px;
      margin-bottom: 8px;
      border: 1px solid rgba(59, 130, 246, 0.2);
    }
    
    .bonus-record-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }
    
    .bonus-record-type {
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    
    .bonus-record-date {
      font-size: 11px;
      color: var(--muted);
    }
    
    .bonus-record-details {
      font-size: 12px;
      color: var(--muted);
      line-height: 1.4;
    }
  </style>
</head>
<body>
  <div id="admin-root">
    <!-- –≠–∫—Ä–∞–Ω –ª–æ–≥–∏–Ω–∞ -->
    <div id="login-card" class="card">
      <div class="logo">üçÄ</div>
      <div class="title">SiaMatch Admin</div>
      <div class="subtitle">–î–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</div>

      <div class="field">
        <label for="password">–ü–∞—Ä–æ–ª—å</label>
        <input type="password" id="password" autocomplete="off" />
        <div class="hint">–í–≤–µ–¥–∏—Ç–µ –∞–¥–º–∏–Ω‚Äë–ø–∞—Ä–æ–ª—å: <strong></strong></div>
      </div>

      <button id="login-btn" class="primary">–í–æ–π—Ç–∏</button>
      <div id="login-error" class="error"></div>
    </div>

    <!-- –≠–∫—Ä–∞–Ω –∞–¥–º–∏–Ω‚Äë–ø–∞–Ω–µ–ª–∏ -->
    <div id="admin-card" class="card hidden">
      <div id="admin-panel-header">
        <div class="left">
          <h2>–ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h2>
          <span>–ú–æ–¥–µ—Ä–∞—Ü–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</span>
        </div>
        <button id="logout-btn">–í—ã–π—Ç–∏</button>
      </div>

      <!-- –¢–∞–±—ã -->
      <div id="admin-tabs">
        <button class="tab-btn active" data-tab="all">–í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</button>
        <button class="tab-btn" data-tab="new">–ù–æ–≤—ã–µ</button>
        <button class="tab-btn" data-tab="verification">–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è ‚è≥</button>
        <button class="tab-btn" data-tab="blocked">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ</button>
        <button class="tab-btn" data-tab="reports">–ñ–∞–ª–æ–±—ã ‚ö†Ô∏è</button>
        <button class="tab-btn" data-tab="bonuses">–ë–æ–Ω—É—Å—ã üéÅ</button>
        <button class="tab-btn" data-tab="search">–ü–æ–∏—Å–∫</button>
      </div>

      <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
      <div id="stats-section" class="stats-grid">
        <div class="stat-card">
          <span class="stat-number total" id="stat-total">0</span>
          <span class="stat-label">–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</span>
        </div>
        <div class="stat-card">
          <span class="stat-number new" id="stat-new">0</span>
          <span class="stat-label">–ù–æ–≤—ã—Ö –∑–∞ 24—á</span>
        </div>
        <div class="stat-card">
          <span class="stat-number pending" id="stat-pending">0</span>
          <span class="stat-label">–ù–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏</span>
        </div>
        <div class="stat-card">
          <span class="stat-number active" id="stat-active">0</span>
          <span class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö</span>
        </div>
        <div class="stat-card">
          <span class="stat-number blocked" id="stat-blocked">0</span>
          <span class="stat-label">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ</span>
        </div>
        <div class="stat-card">
          <span class="stat-number boosted" id="stat-boosted">0</span>
          <span class="stat-label">–° –±—É—Å—Ç–æ–º</span>
        </div>
        <div class="stat-card">
          <span class="stat-number reports" id="stat-reports">0</span>
          <span class="stat-label">–ñ–∞–ª–æ–± ‚ö†Ô∏è</span>
        </div>
        <!-- –ù–û–í–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê -->
        <div class="stat-card">
          <span class="stat-number bonus-swipes" id="stat-bonus-swipes">0</span>
          <span class="stat-label">–ë–æ–Ω—É—Å–Ω—ã—Ö —Å–≤–∞–π–ø–æ–≤</span>
        </div>
        <div class="stat-card">
          <span class="stat-number invites" id="stat-invites">0</span>
          <span class="stat-label">–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π</span>
        </div>
        <div class="stat-card">
          <span class="stat-number shares" id="stat-shares">0</span>
          <span class="stat-label">–®–µ—Ä–æ–≤ –≤ Stories</span>
        </div>
      </div>

      <!-- –ë–∞–Ω–Ω–µ—Ä—ã —Ä–∞–∑–¥–µ–ª–æ–≤ -->
      <div id="section-banner-all" class="section-banner all">
        <h3>–í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h3>
        <p>–ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –ú–æ–∂–Ω–æ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å, —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å –º–æ–¥–µ—Ä–∞—Ü–∏—é.</p>
      </div>

      <div id="section-banner-new" class="section-banner new hidden">
        <h3>–ù–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h3>
        <p>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–≤—à–∏–µ—Å—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞. –û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.</p>
      </div>

      <div id="section-banner-verification" class="section-banner verification hidden">
        <h3>–ó–∞—è–≤–∫–∏ –Ω–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é ‚è≥</h3>
        <p>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ–ª—Ñ–∏-—Ñ–æ—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –∏–ª–∏ –æ—Ç–∫–ª–æ–Ω–∏—Ç–µ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é.</p>
      </div>

      <div id="section-banner-blocked" class="section-banner blocked hidden">
        <h3>–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h3>
        <p>–ê–Ω–∫–µ—Ç—ã, –≤—Ä–µ–º–µ–Ω–Ω–æ –∏–ª–∏ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω–Ω—ã–µ –æ—Ç –ø–æ–∫–∞–∑–∞ –≤ –ª–µ–Ω—Ç–µ.</p>
      </div>

      <div id="section-banner-reports" class="section-banner reports hidden">
        <h3>–ñ–∞–ª–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π ‚ö†Ô∏è</h3>
        <p>–ü—Ä–æ—Å–º–æ—Ç—Ä –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∂–∞–ª–æ–± –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ –≤–∏–¥–µ—Ç—å –¥–∏–∞–ª–æ–≥–∏, –ø—Ä–∏—á–∏–Ω—ã –∂–∞–ª–æ–± –∏ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –º–µ—Ä—ã.</p>
      </div>

      <!-- –ù–û–í–´–ô –ë–ê–ù–ù–ï–† –î–õ–Ø –ë–û–ù–£–°–û–í -->
      <div id="section-banner-bonuses" class="section-banner bonuses hidden">
        <h3>–ë–æ–Ω—É—Å–Ω—ã–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π üéÅ</h3>
        <p>–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—é –¥—Ä—É–∑–µ–π, —à–µ—Ä–∏–Ω–≥—É –≤ Stories –∏ –¥—Ä—É–≥–∏–º –±–æ–Ω—É—Å–Ω—ã–º –¥–µ–π—Å—Ç–≤–∏—è–º. –ù–∞—á–∏—Å–ª—è–π—Ç–µ –±–æ–Ω—É—Å—ã –≤—Ä—É—á–Ω—É—é.</p>
      </div>

      <div id="section-banner-search" class="section-banner search hidden">
        <h3>–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫</h3>
        <p>–ü–æ–∏—Å–∫ –ø–æ –≤—Å–µ–º –ø–æ–ª—è–º –∞–Ω–∫–µ—Ç—ã. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∏–ª—å—Ç—Ä—ã –¥–ª—è —Ç–æ—á–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.</p>
      </div>

      <!-- –ü–æ–∏—Å–∫–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è –≤–∫–ª–∞–¥–∫–∏ "–ü–æ–∏—Å–∫") -->
      <div id="search-row" class="hidden">
        <input
          type="text"
          id="search-input"
          placeholder="–ü–æ–∏—Å–∫ –ø–æ ID, –∏–º–µ–Ω–∏, username, –≥–æ—Ä–æ–¥—É..."
        />
        <button id="search-btn" class="primary">–ù–∞–π—Ç–∏</button>
      </div>

      <!-- –§–∏–ª—å—Ç—Ä—ã (—Ç–æ–ª—å–∫–æ –¥–ª—è –≤–∫–ª–∞–¥–∫–∏ "–ü–æ–∏—Å–∫") -->
      <div id="filters-row" class="hidden">
        <select id="filter-gender" class="filter-select">
          <option value="">–í—Å–µ –ø–æ–ª—ã</option>
          <option value="male">–ú—É–∂—Å–∫–æ–π</option>
          <option value="female">–ñ–µ–Ω—Å–∫–∏–π</option>
        </select>
        <select id="filter-city" class="filter-select">
          <option value="">–í—Å–µ –≥–æ—Ä–æ–¥–∞</option>
          <option value="–ú–æ—Å–∫–≤–∞">–ú–æ—Å–∫–≤–∞</option>
          <option value="–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥">–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥</option>
          <option value="–ö–∞–∑–∞–Ω—å">–ö–∞–∑–∞–Ω—å</option>
        </select>
        <select id="filter-verification" class="filter-select">
          <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
          <option value="not_verified">–ù–µ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã</option>
          <option value="pending">–ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ</option>
          <option value="verified">–í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã</option>
          <option value="rejected">–û—Ç–∫–ª–æ–Ω–µ–Ω—ã</option>
        </select>
        <input type="number" id="filter-age-min" class="filter-select" placeholder="–í–æ–∑—Ä–∞—Å—Ç –æ—Ç" min="18" max="99">
        <input type="number" id="filter-age-max" class="filter-select" placeholder="–¥–æ" min="18" max="99">
      </div>

      <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã -->
      <div id="results-info">–ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ...</div>
      <ul id="users-list"></ul>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ -->
  <div id="verification-modal" class="modal-overlay hidden">
    <div class="modal">
      <div class="modal-header">
        <h3>–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏</h3>
        <button class="close-btn" id="close-modal-btn">√ó</button>
      </div>
      <div id="modal-content">
        <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –±—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
      </div>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –±—É—Å—Ç–∞ –∞–Ω–∫–µ—Ç—ã -->
  <div id="boost-modal" class="modal-overlay hidden">
    <div class="modal" style="max-width: 400px;">
      <div class="modal-header">
        <h3>üöÄ –ë—É—Å—Ç –∞–Ω–∫–µ—Ç—ã</h3>
        <button class="close-btn" id="close-boost-modal-btn">√ó</button>
      </div>
      <div id="boost-modal-content">
        <div style="margin-bottom: 20px;">
          <div style="font-size: 14px; color: var(--muted); margin-bottom: 10px;">
            ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: <span id="boost-user-id">-</span><br>
            –ò–º—è: <span id="boost-user-name">-</span>
          </div>
          
          <div class="field">
            <label for="boost-duration-admin">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±—É—Å—Ç–∞</label>
            <select id="boost-duration-admin" class="filter-select" style="width: 100%;">
              <option value="24">24 —á–∞—Å–∞</option>
              <option value="72">72 —á–∞—Å–∞ (3 –¥–Ω—è)</option>
              <option value="168">7 –¥–Ω–µ–π</option>
              <option value="720">30 –¥–Ω–µ–π</option>
              <option value="custom">–°–≤–æ–π —Å—Ä–æ–∫</option>
            </select>
          </div>
          
          <div id="custom-boost-duration" class="hidden">
            <div class="field">
              <label for="custom-days">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π</label>
              <input type="number" id="custom-days" min="1" max="365" value="7" class="filter-select" style="width: 100%;" />
            </div>
          </div>
          
          <div class="field">
            <label for="boost-reason">–ü—Ä–∏—á–∏–Ω–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
            <textarea id="boost-reason" rows="2" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ü—Ä–æ–º–æ-–∞–∫—Ü–∏—è, –ñ–∞–ª–æ–±–∞ –Ω–∞ –≤–∏–¥–∏–º–æ—Å—Ç—å..." style="width: 100%; padding: 8px; border-radius: 8px; border: 1px solid #1f2937; background: #020617; color: var(--text); font-size: 13px;"></textarea>
          </div>
        </div>
        
        <div class="modal-actions">
          <button id="apply-boost-btn" class="primary boost-btn">–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –±—É—Å—Ç</button>
        </div>
      </div>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø–æ–¥–∞—Ä–∫–∞ —Å–≤–∞–π–ø–æ–≤ -->
  <div id="swipes-modal" class="modal-overlay hidden">
    <div class="modal" style="max-width: 400px;">
      <div class="modal-header">
        <h3>üîÑ –ü–æ–¥–∞—Ä–∏—Ç—å —Å–≤–∞–π–ø—ã</h3>
        <button class="close-btn" id="close-swipes-modal-btn">√ó</button>
      </div>
      <div id="swipes-modal-content">
        <div style="margin-bottom: 20px;">
          <div style="font-size: 14px; color: var(--muted); margin-bottom: 10px;">
            ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: <span id="swipes-user-id">-</span><br>
            –ò–º—è: <span id="swipes-user-name">-</span>
          </div>
          
          <div class="field">
            <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–∞–π–ø–æ–≤</label>
            <div style="display: flex; flex-wrap: wrap; gap: 8px; margin-top: 8px;">
              <button class="swipe-amount-btn" data-amount="10">10</button>
              <button class="swipe-amount-btn" data-amount="25">25</button>
              <button class="swipe-amount-btn" data-amount="50">50</button>
              <button class="swipe-amount-btn" data-amount="100">100</button>
              <button class="swipe-amount-btn" data-amount="200">200</button>
              <button class="swipe-amount-btn" data-amount="500">500</button>
            </div>
          </div>
          
          <div class="field">
            <label for="custom-swipes">–ò–ª–∏ –≤–≤–µ–¥–∏—Ç–µ —Å–≤–æ—ë –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ</label>
            <input type="number" id="custom-swipes" min="1" max="1000" value="50" class="filter-select" style="width: 100%;" />
          </div>
          
          <div class="field">
            <label for="swipes-reason">–ü—Ä–∏—á–∏–Ω–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
            <textarea id="swipes-reason" rows="2" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è, –ü—Ä–æ–º–æ-–∞–∫—Ü–∏—è, –ë–æ–Ω—É—Å..." style="width: 100%; padding: 8px; border-radius: 8px; border: 1px solid #1f2937; background: #020617; color: var(--text); font-size: 13px;"></textarea>
          </div>
        </div>
        
        <div class="modal-actions">
          <button id="apply-swipes-btn" class="primary">–ü–æ–¥–∞—Ä–∏—Ç—å —Å–≤–∞–π–ø—ã</button>
        </div>
      </div>
    </div>
  </div>

  <!-- –ù–û–í–û–ï: –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –±–æ–Ω—É—Å–æ–≤ -->
  <div id="bonus-modal" class="modal-overlay hidden">
    <div class="modal" style="max-width: 500px;">
      <div class="modal-header">
        <h3>üéÅ –ù–∞—á–∏—Å–ª–∏—Ç—å –±–æ–Ω—É—Å</h3>
        <button class="close-btn" id="close-bonus-modal-btn">√ó</button>
      </div>
      <div id="bonus-modal-content">
        <div style="margin-bottom: 20px;">
          <div style="font-size: 14px; color: var(--muted); margin-bottom: 10px;">
            ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: <span id="bonus-user-id">-</span><br>
            –ò–º—è: <span id="bonus-user-name">-</span>
          </div>
          
          <div class="field">
            <label for="bonus-type">–¢–∏–ø –±–æ–Ω—É—Å–∞</label>
            <select id="bonus-type" class="filter-select" style="width: 100%;">
              <option value="verification">–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∞–Ω–∫–µ—Ç—ã (+20 —Å–≤–∞–π–ø–æ–≤)</option>
              <option value="invite">–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –¥—Ä—É–≥–∞ (+20 —Å–≤–∞–π–ø–æ–≤)</option>
              <option value="share">–®–µ—Ä–∏–Ω–≥ –≤ Stories (+24—á –±—É—Å—Ç)</option>
              <option value="custom_swipes">–°–≤–∞–π–ø—ã (–ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ)</option>
              <option value="custom_boost">–ë—É—Å—Ç (–ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)</option>
              <option value="other">–î—Ä—É–≥–æ–π –±–æ–Ω—É—Å</option>
            </select>
          </div>
          
          <div id="custom-bonus-amount" class="hidden">
            <div class="field">
              <label for="custom-bonus-amount-input">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–∞–π–ø–æ–≤</label>
              <input type="number" id="custom-bonus-amount-input" min="1" max="1000" value="20" class="filter-select" style="width: 100%;" />
            </div>
          </div>
          
          <div id="custom-boost-hours" class="hidden">
            <div class="field">
              <label for="custom-boost-hours-input">–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±—É—Å—Ç–∞ (—á–∞—Å—ã)</label>
              <input type="number" id="custom-boost-hours-input" min="1" max="720" value="24" class="filter-select" style="width: 100%;" />
            </div>
          </div>
          
          <div class="field">
            <label for="bonus-reason">–ü—Ä–∏—á–∏–Ω–∞ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è</label>
            <select id="bonus-reason" class="filter-select" style="width: 100%;">
              <option value="verification_success">–£—Å–ø–µ—à–Ω–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è</option>
              <option value="invite_friend">–ü—Ä–∏–≥–ª–∞—Å–∏–ª –¥—Ä—É–≥–∞</option>
              <option value="shared_stories">–ü–æ–¥–µ–ª–∏–ª—Å—è –≤ Stories</option>
              <option value="promo">–ü—Ä–æ–º–æ-–∞–∫—Ü–∏—è</option>
              <option value="compensation">–ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è</option>
              <option value="loyalty">–õ–æ—è–ª—å–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</option>
              <option value="other">–î—Ä—É–≥–æ–µ</option>
            </select>
          </div>
          
          <div class="field">
            <label for="bonus-comment">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
            <textarea id="bonus-comment" rows="2" placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–æ–Ω—É—Å–µ..." style="width: 100%; padding: 8px; border-radius: 8px; border: 1px solid #1f2937; background: #020617; color: var(--text); font-size: 13px;"></textarea>
          </div>
        </div>
        
        <div class="modal-actions">
          <button id="apply-bonus-btn" class="primary invite-btn">–ù–∞—á–∏—Å–ª–∏—Ç—å –±–æ–Ω—É—Å</button>
        </div>
      </div>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∂–∞–ª–æ–±—ã -->
  <div id="report-details-modal" class="modal-overlay hidden">
    <div class="modal" style="max-width: 800px;">
      <div class="modal-header">
        <h3>‚ö†Ô∏è –î–µ—Ç–∞–ª–∏ –∂–∞–ª–æ–±—ã #<span id="report-details-id">0</span></h3>
        <button class="close-btn" id="close-report-details-btn">√ó</button>
      </div>
      <div id="report-details-content" class="report-details-content">
        <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –±—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
      </div>
    </div>
  </div>

  <!-- –ù–û–í–û–ï: –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏—Å—Ç–æ—Ä–∏–∏ –±–æ–Ω—É—Å–æ–≤ -->
  <div id="bonus-history-modal" class="modal-overlay hidden">
    <div class="modal" style="max-width: 600px;">
      <div class="modal-header">
        <h3>üìã –ò—Å—Ç–æ—Ä–∏—è –±–æ–Ω—É—Å–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>
        <button class="close-btn" id="close-bonus-history-btn">√ó</button>
      </div>
      <div id="bonus-history-content">
        <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –±—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
      </div>
    </div>
  </div>

  <script>
    // –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã
    const ADMIN_PASSWORD = "s21i06a95";

    // DOM —ç–ª–µ–º–µ–Ω—Ç—ã - –ª–æ–≥–∏–Ω
    const loginCard = document.getElementById("login-card");
    const adminCard = document.getElementById("admin-card");
    const loginBtn = document.getElementById("login-btn");
    const logoutBtn = document.getElementById("logout-btn");
    const passwordInput = document.getElementById("password");
    const loginError = document.getElementById("login-error");

    // DOM —ç–ª–µ–º–µ–Ω—Ç—ã - —Ç–∞–±—ã
    const tabButtons = document.querySelectorAll(".tab-btn");
    
    // DOM —ç–ª–µ–º–µ–Ω—Ç—ã - –ø–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä—ã
    const searchRow = document.getElementById("search-row");
    const filtersRow = document.getElementById("filters-row");
    const searchInput = document.getElementById("search-input");
    const searchBtn = document.getElementById("search-btn");
    const filterGender = document.getElementById("filter-gender");
    const filterCity = document.getElementById("filter-city");
    const filterVerification = document.getElementById("filter-verification");
    const filterAgeMin = document.getElementById("filter-age-min");
    const filterAgeMax = document.getElementById("filter-age-max");

    // DOM —ç–ª–µ–º–µ–Ω—Ç—ã - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    const resultsInfo = document.getElementById("results-info");
    const usersList = document.getElementById("users-list");

    // DOM —ç–ª–µ–º–µ–Ω—Ç—ã - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (–¥–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ)
    const statTotal = document.getElementById("stat-total");
    const statNew = document.getElementById("stat-new");
    const statPending = document.getElementById("stat-pending");
    const statActive = document.getElementById("stat-active");
    const statBlocked = document.getElementById("stat-blocked");
    const statBoosted = document.getElementById("stat-boosted");
    const statReports = document.getElementById("stat-reports");
    const statBonusSwipes = document.getElementById("stat-bonus-swipes");
    const statInvites = document.getElementById("stat-invites");
    const statShares = document.getElementById("stat-shares");

    // DOM —ç–ª–µ–º–µ–Ω—Ç—ã - –±–∞–Ω–Ω–µ—Ä—ã
    const sectionBanners = {
      all: document.getElementById("section-banner-all"),
      new: document.getElementById("section-banner-new"),
      verification: document.getElementById("section-banner-verification"),
      blocked: document.getElementById("section-banner-blocked"),
      reports: document.getElementById("section-banner-reports"),
      bonuses: document.getElementById("section-banner-bonuses"),
      search: document.getElementById("section-banner-search")
    };

    // DOM —ç–ª–µ–º–µ–Ω—Ç—ã - –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
    const verificationModal = document.getElementById("verification-modal");
    const closeModalBtn = document.getElementById("close-modal-btn");
    const modalContent = document.getElementById("modal-content");

    // DOM —ç–ª–µ–º–µ–Ω—Ç—ã - –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –±—É—Å—Ç–∞
    const boostModal = document.getElementById('boost-modal');
    const closeBoostModalBtn = document.getElementById('close-boost-modal-btn');
    const applyBoostBtn = document.getElementById('apply-boost-btn');
    const boostDurationSelect = document.getElementById('boost-duration-admin');
    const customBoostDuration = document.getElementById('custom-boost-duration');
    const customDaysInput = document.getElementById('custom-days');
    const boostReasonInput = document.getElementById('boost-reason');

    // DOM —ç–ª–µ–º–µ–Ω—Ç—ã - –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–≤–∞–π–ø–æ–≤
    const swipesModal = document.getElementById('swipes-modal');
    const closeSwipesModalBtn = document.getElementById('close-swipes-modal-btn');
    const applySwipesBtn = document.getElementById('apply-swipes-btn');
    const customSwipesInput = document.getElementById('custom-swipes');
    const swipesReasonInput = document.getElementById('swipes-reason');

    // –ù–û–í–´–ï: DOM —ç–ª–µ–º–µ–Ω—Ç—ã - –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –±–æ–Ω—É—Å–æ–≤
    const bonusModal = document.getElementById('bonus-modal');
    const closeBonusModalBtn = document.getElementById('close-bonus-modal-btn');
    const applyBonusBtn = document.getElementById('apply-bonus-btn');
    const bonusTypeSelect = document.getElementById('bonus-type');
    const customBonusAmountDiv = document.getElementById('custom-bonus-amount');
    const customBoostHoursDiv = document.getElementById('custom-boost-hours');
    const customBonusAmountInput = document.getElementById('custom-bonus-amount-input');
    const customBoostHoursInput = document.getElementById('custom-boost-hours-input');
    const bonusReasonSelect = document.getElementById('bonus-reason');
    const bonusCommentInput = document.getElementById('bonus-comment');

    // –ù–û–í–´–ï: DOM —ç–ª–µ–º–µ–Ω—Ç—ã - –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏—Å—Ç–æ—Ä–∏–∏ –±–æ–Ω—É—Å–æ–≤
    const bonusHistoryModal = document.getElementById('bonus-history-modal');
    const closeBonusHistoryBtn = document.getElementById('close-bonus-history-btn');
    const bonusHistoryContent = document.getElementById('bonus-history-content');

    // DOM —ç–ª–µ–º–µ–Ω—Ç—ã - –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–µ—Ç–∞–ª–µ–π –∂–∞–ª–æ–±—ã
    const reportDetailsModal = document.getElementById('report-details-modal');
    const closeReportDetailsBtn = document.getElementById('close-report-details-btn');
    const reportDetailsContent = document.getElementById('report-details-content');
    const reportDetailsId = document.getElementById('report-details-id');

    // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
    let currentTab = "all";
    let allUsers = [];
    let filteredUsers = [];
    let allReports = [];
    let allBonuses = []; // –ù–û–í–û–ï: –º–∞—Å—Å–∏–≤ –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏ –±–æ–Ω—É—Å–æ–≤
    let currentUserForBoost = null;
    let currentUserForSwipes = null;
    let currentUserForBonus = null; // –ù–û–í–û–ï
    let currentUserForBonusHistory = null; // –ù–û–í–û–ï
    let currentReportForDetails = null;

    // –ù–û–í–ê–Ø –§–£–ù–ö–¶–ò–Ø: –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–µ–º–æ-–¥–∞–Ω–Ω—ã—Ö –±–æ–Ω—É—Å–æ–≤
    function generateDemoBonuses(count = 20) {
      const bonuses = [];
      const bonusTypes = [
        { type: 'verification', name: '–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∞–Ω–∫–µ—Ç—ã', icon: 'üîê', swipes: 20 },
        { type: 'invite', name: '–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –¥—Ä—É–≥–∞', icon: 'üë•', swipes: 20 },
        { type: 'share', name: '–®–µ—Ä–∏–Ω–≥ –≤ Stories', icon: 'üì±', boost: 24 },
        { type: 'custom_swipes', name: '–ë–æ–Ω—É—Å–Ω—ã–µ —Å–≤–∞–π–ø—ã', icon: 'üîÑ', swipes: 50 },
        { type: 'custom_boost', name: '–ë–æ–Ω—É—Å–Ω—ã–π –±—É—Å—Ç', icon: 'üöÄ', boost: 72 }
      ];
      
      const reasons = [
        'verification_success', 'invite_friend', 'shared_stories', 
        'promo', 'compensation', 'loyalty', 'other'
      ];
      
      const reasonTexts = {
        'verification_success': '–£—Å–ø–µ—à–Ω–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è',
        'invite_friend': '–ü—Ä–∏–≥–ª–∞—Å–∏–ª –¥—Ä—É–≥–∞',
        'shared_stories': '–ü–æ–¥–µ–ª–∏–ª—Å—è –≤ Stories',
        'promo': '–ü—Ä–æ–º–æ-–∞–∫—Ü–∏—è',
        'compensation': '–ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è',
        'loyalty': '–õ–æ—è–ª—å–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è',
        'other': '–î—Ä—É–≥–æ–µ'
      };
      
      // –ë–µ—Ä–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ allUsers –¥–ª—è –¥–µ–º–æ
      const demoUsers = allUsers.slice(0, 15);
      
      for (let i = 1; i <= count; i++) {
        const user = demoUsers[Math.floor(Math.random() * demoUsers.length)];
        const bonusType = bonusTypes[Math.floor(Math.random() * bonusTypes.length)];
        const reason = reasons[Math.floor(Math.random() * reasons.length)];
        
        const createdAt = new Date(Date.now() - Math.floor(Math.random() * 30) * 24 * 60 * 60 * 1000);
        
        let details = '';
        if (bonusType.swipes) {
          details = `+${bonusType.swipes} —Å–≤–∞–π–ø–æ–≤`;
        } else if (bonusType.boost) {
          details = `–ë—É—Å—Ç –Ω–∞ ${bonusType.boost} —á–∞—Å–∞`;
        }
        
        bonuses.push({
          id: i,
          userId: user.id,
          userName: user.name,
          type: bonusType.type,
          typeName: bonusType.name,
          icon: bonusType.icon,
          details: details,
          swipes: bonusType.swipes || 0,
          boostHours: bonusType.boost || 0,
          reason: reason,
          reasonText: reasonTexts[reason],
          comment: reason === 'other' ? '–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –±–æ–Ω—É—Å –æ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏' : '',
          adminName: '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä',
          createdAt: createdAt.toISOString(),
          status: 'completed'
        });
      }
      
      return bonuses;
    }

    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–µ–º–æ-–¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    function generateDemoUsers(count = 50) {
      const cities = ["–ú–æ—Å–∫–≤–∞", "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥", "–ö–∞–∑–∞–Ω—å", "–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫", "–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥", "–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä"];
      const names = {
        male: ["–ê–ª–µ–∫—Å–∞–Ω–¥—Ä", "–î–º–∏—Ç—Ä–∏–π", "–ú–∞–∫—Å–∏–º", "–ê—Ä—Ç—ë–º", "–ò–≤–∞–Ω", "–ö–∏—Ä–∏–ª–ª", "–ú–∏—Ö–∞–∏–ª"],
        female: ["–ê–Ω–∞—Å—Ç–∞—Å–∏—è", "–ú–∞—Ä–∏—è", "–ê–Ω–Ω–∞", "–í–∏–∫—Ç–æ—Ä–∏—è", "–ï–∫–∞—Ç–µ—Ä–∏–Ω–∞", "–ï–ª–µ–Ω–∞", "–û–ª—å–≥–∞"]
      };
      
      const verificationStatuses = ['not_verified', 'pending', 'verified', 'rejected'];
      
      const users = [];
      const now = new Date();
      const dayMs = 24 * 60 * 60 * 1000;
      
      for (let i = 1; i <= count; i++) {
        const gender = Math.random() > 0.5 ? "male" : "female";
        const nameList = names[gender];
        const name = nameList[Math.floor(Math.random() * nameList.length)];
        
        // –°–ª—É—á–∞–π–Ω–∞—è –¥–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ (–æ—Ç 1 –¥–æ 30 –¥–Ω–µ–π –Ω–∞–∑–∞–¥)
        const daysAgo = Math.floor(Math.random() * 30);
        const registrationDate = new Date(now.getTime() - daysAgo * dayMs);
        
        // 10% –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã
        const blocked = Math.random() < 0.1;
        
        // 20% –Ω–æ–≤—ã—Ö (–∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞)
        const isNew = daysAgo === 0;
        
        // –°—Ç–∞—Ç—É—Å –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
        const verificationStatus = verificationStatuses[Math.floor(Math.random() * verificationStatuses.length)];
        const verified = verificationStatus === 'verified';
        
        // 15% –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∞–∫—Ç–∏–≤–Ω—ã–º –±—É—Å—Ç–æ–º
        const boosted = Math.random() < 0.15;
        const boostEnd = boosted ? new Date(now.getTime() + Math.floor(Math.random() * 7) * dayMs) : null;
        
        // –î–µ–º–æ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –±–æ–Ω—É—Å–æ–≤
        const bonusSwipes = Math.floor(Math.random() * 100);
        const invitedFriends = Math.floor(Math.random() * 5);
        const sharedStories = Math.floor(Math.random() * 3);
        
        // –§–æ—Ç–æ –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–¥–µ–º–æ)
        const verificationPhoto = (verified || verificationStatus === 'pending') ? 
          `https://randomuser.me/api/portraits/${gender === 'male' ? 'men' : 'women'}/${i % 50}.jpg` : null;
        
        // –û—Å–Ω–æ–≤–Ω–æ–µ —Ñ–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª—è
        const profilePhoto = `https://randomuser.me/api/portraits/${gender === 'male' ? 'men' : 'women'}/${i % 50}.jpg`;
        
        users.push({
          id: i,
          name: name,
          age: 18 + Math.floor(Math.random() * 30),
          gender: gender,
          username: `${name.toLowerCase()}_${i}`,
          city: cities[Math.floor(Math.random() * cities.length)],
          bio: "–õ—é–±–ª—é –∞–∫—Ç–∏–≤–Ω—ã–π –æ—Ç–¥—ã—Ö –∏ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è",
          registration_date: registrationDate.toISOString().split('T')[0],
          days_ago: daysAgo,
          blocked: blocked,
          is_new: isNew,
          last_active: new Date(now.getTime() - Math.floor(Math.random() * 7) * dayMs).toISOString(),
          verification_status: verificationStatus,
          verified: verified,
          verification_photo: verificationPhoto,
          profile_photo: profilePhoto,
          verification_request_date: verificationStatus === 'pending' ? 
            new Date(now.getTime() - Math.floor(Math.random() * 24) * 60 * 60 * 1000).toISOString() : null,
          boosted: boosted,
          boost_end: boostEnd ? boostEnd.toISOString() : null,
          remaining_swipes: Math.floor(Math.random() * 30) + bonusSwipes,
          // –ù–û–í–´–ï –ü–û–õ–Ø –î–õ–Ø –ë–û–ù–£–°–û–í
          bonus_swipes: bonusSwipes,
          invited_friends: invitedFriends,
          shared_stories: sharedStories,
          total_bonuses: Math.floor(Math.random() * 5) + 1
        });
      }
      
      return users;
    }

    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–µ–º–æ-–¥–∞–Ω–Ω—ã—Ö –∂–∞–ª–æ–±
    function generateDemoReports(count = 8) {
      const reports = [];
      const reasons = ['spam', 'harassment', 'fake', 'scam', 'inappropriate', 'other'];
      const statuses = ['pending', 'reviewing', 'resolved', 'rejected'];
      const reasonTexts = {
        'spam': '–°–ø–∞–º, —Ä–µ–∫–ª–∞–º–∞',
        'harassment': '–û—Å–∫–æ—Ä–±–ª–µ–Ω–∏—è, —Ö–∞—Ä–∞—Å—Å–º–µ–Ω—Ç',
        'fake': '–§–µ–π–∫–æ–≤–∞—è –∞–Ω–∫–µ—Ç–∞',
        'scam': '–ú–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ',
        'inappropriate': '–ù–µ—É–º–µ—Å—Ç–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç',
        'other': '–ù–µ—É–≤–∞–∂–∏—Ç–µ–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ'
      };
      
      // –ë–µ—Ä–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ allUsers –¥–ª—è –¥–µ–º–æ
      const demoUsers = allUsers.slice(0, 15);
      
      for (let i = 1; i <= count; i++) {
        const reporter = demoUsers[Math.floor(Math.random() * demoUsers.length)];
        const reported = demoUsers[Math.floor(Math.random() * demoUsers.length)];
        
        const reason = reasons[Math.floor(Math.random() * reasons.length)];
        const status = statuses[Math.floor(Math.random() * statuses.length)];
        
        // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–µ–º–æ —Å–æ–æ–±—â–µ–Ω–∏—è
        const demoChatMessages = [];
        const messageCount = Math.floor(Math.random() * 8) + 3;
        
        for (let j = 0; j < messageCount; j++) {
          const sender = Math.random() > 0.5 ? 'reporter' : 'reported';
          const messages = [
            "–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ –¥–µ–ª–∞?",
            "–í—Å—ë –æ—Ç–ª–∏—á–Ω–æ, –∞ —É —Ç–µ–±—è?",
            "–•–æ—Ä–æ—à–æ! –ß–µ–º –∑–∞–Ω–∏–º–∞–µ—à—å—Å—è?",
            "–ù–∏—á–µ–≥–æ –æ—Å–æ–±–µ–Ω–Ω–æ–≥–æ, –ø—Ä–æ—Å—Ç–æ –æ—Ç–¥—ã—Ö–∞—é",
            "–î–∞–≤–∞–π –≤—Å—Ç—Ä–µ—Ç–∏–º—Å—è –∫–∞–∫-–Ω–∏–±—É–¥—å",
            "–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —Ç–≤–æ—è –∞–Ω–∫–µ—Ç–∞",
            "–°–ø–∞—Å–∏–±–æ! –¢–≤–æ—è —Ç–æ–∂–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è",
            "–ü–æ–∫–∞, —Ö–æ—Ä–æ—à–µ–≥–æ –¥–Ω—è!",
            "–î–æ —Å–≤–∏–¥–∞–Ω–∏—è, –±—É–¥–µ–º –Ω–∞ —Å–≤—è–∑–∏"
          ];
          
          const now = new Date(Date.now() - Math.floor(Math.random() * 7) * 24 * 60 * 60 * 1000);
          const timeString = now.toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' });
          const dateString = now.toISOString().split('T')[0];
          
          demoChatMessages.push({
            id: j + 1,
            sender: sender,
            text: messages[Math.floor(Math.random() * messages.length)],
            time: timeString,
            date: dateString
          });
        }
        
        const createdAt = new Date(Date.now() - Math.floor(Math.random() * 7) * 24 * 60 * 60 * 1000);
        
        reports.push({
          id: i,
          reporterId: reporter.id,
          reporterName: reporter.name,
          reporterProfile: reporter,
          reportedUserId: reported.id,
          reportedUserName: reported.name,
          reportedUserProfile: reported,
          reason: reasonTexts[reason],
          additionalInfo: reason === 'other' ? '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–µ–ª —Å–µ–±—è –Ω–µ–ø–æ–¥–æ–±–∞—é—â–∏–º –æ–±—Ä–∞–∑–æ–º –≤ —á–∞—Ç–µ' : '',
          chatMessages: demoChatMessages,
          createdAt: createdAt.toISOString(),
          status: status,
          adminResponse: status === 'resolved' ? '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω –æ –ø—Ä–∞–≤–∏–ª–∞—Ö –ø–æ–≤–µ–¥–µ–Ω–∏—è' : 
                       status === 'rejected' ? '–ñ–∞–ª–æ–±–∞ –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª–∞—Å—å' : null,
          resolvedAt: status === 'resolved' || status === 'rejected' ? 
                     new Date(createdAt.getTime() + Math.floor(Math.random() * 24) * 60 * 60 * 1000).toISOString() : null
        });
      }
      
      return reports;
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    function updateStats() {
      const total = allUsers.length;
      const newUsers = allUsers.filter(u => u.is_new).length;
      const blocked = allUsers.filter(u => u.blocked).length;
      const pendingVerification = allUsers.filter(u => u.verification_status === 'pending').length;
      const active = total - blocked;
      const boosted = allUsers.filter(u => u.boosted).length;
      const pendingReports = allReports.filter(r => r.status === 'pending').length;
      
      // –ù–û–í–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê –î–õ–Ø –ë–û–ù–£–°–û–í
      const totalBonusSwipes = allUsers.reduce((sum, u) => sum + (u.bonus_swipes || 0), 0);
      const totalInvites = allUsers.reduce((sum, u) => sum + (u.invited_friends || 0), 0);
      const totalShares = allUsers.reduce((sum, u) => sum + (u.shared_stories || 0), 0);
      
      statTotal.textContent = total;
      statNew.textContent = newUsers;
      statPending.textContent = pendingVerification;
      statActive.textContent = active;
      statBlocked.textContent = blocked;
      statBoosted.textContent = boosted;
      statReports.textContent = pendingReports;
      // –ù–û–í–´–ï –°–¢–ê–¢–ò–°–¢–ò–ö–ò
      statBonusSwipes.textContent = totalBonusSwipes;
      statInvites.textContent = totalInvites;
      statShares.textContent = totalShares;
    }

    // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ —Ç–µ–∫—É—â–µ–π –≤–∫–ª–∞–¥–∫–µ
    function filterUsersByTab() {
      let filtered = [...allUsers];
      
      switch(currentTab) {
        case "all":
          // –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ ID (–Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É)
          filtered.sort((a, b) => b.id - a.id);
          break;
          
        case "new":
          // –¢–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ (–∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞)
          filtered = allUsers.filter(u => u.is_new);
          filtered.sort((a, b) => b.id - a.id);
          break;
          
        case "verification":
          // –¢–æ–ª—å–∫–æ –Ω–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
          filtered = allUsers.filter(u => u.verification_status === 'pending');
          filtered.sort((a, b) => {
            if (!a.verification_request_date || !b.verification_request_date) return 0;
            return new Date(b.verification_request_date) - new Date(a.verification_request_date);
          });
          break;
          
        case "blocked":
          // –¢–æ–ª—å–∫–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ
          filtered = allUsers.filter(u => u.blocked);
          filtered.sort((a, b) => b.id - a.id);
          break;
          
        case "search":
          // –ü–æ–∏—Å–∫ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
          const searchTerm = searchInput.value.trim().toLowerCase();
          const genderFilter = filterGender.value;
          const cityFilter = filterCity.value;
          const verificationFilter = filterVerification.value;
          const ageMin = parseInt(filterAgeMin.value) || 18;
          const ageMax = parseInt(filterAgeMax.value) || 99;
          
          filtered = allUsers.filter(u => {
            // –ü–æ–∏—Å–∫ –ø–æ —Ç–µ–∫—Å—Ç—É
            const matchesSearch = !searchTerm || 
              String(u.id).includes(searchTerm) ||
              u.name.toLowerCase().includes(searchTerm) ||
              u.username.toLowerCase().includes(searchTerm) ||
              u.city.toLowerCase().includes(searchTerm);
            
            // –§–∏–ª—å—Ç—Ä –ø–æ –ø–æ–ª—É
            const matchesGender = !genderFilter || u.gender === genderFilter;
            
            // –§–∏–ª—å—Ç—Ä –ø–æ –≥–æ—Ä–æ–¥—É
            const matchesCity = !cityFilter || u.city === cityFilter;
            
            // –§–∏–ª—å—Ç—Ä –ø–æ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
            const matchesVerification = !verificationFilter || u.verification_status === verificationFilter;
            
            // –§–∏–ª—å—Ç—Ä –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É
            const matchesAge = u.age >= ageMin && u.age <= ageMax;
            
            return matchesSearch && matchesGender && matchesCity && matchesVerification && matchesAge;
          });
          
          filtered.sort((a, b) => b.id - a.id);
          break;
      }
      
      filteredUsers = filtered;
      return filtered;
    }

    // –ó–∞–≥—Ä—É–∑–∫–∞ –∂–∞–ª–æ–±
    function loadReports() {
      try {
        // –ü—ã—Ç–∞–µ–º—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ localStorage (–∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
        const saved = localStorage.getItem('siamatch_admin_reports');
        if (saved) {
          allReports = JSON.parse(saved);
          console.log('üìÇ –ó–∞–≥—Ä—É–∂–µ–Ω–æ –∂–∞–ª–æ–± –∏–∑ localStorage:', allReports.length);
        }
        
        // –ï—Å–ª–∏ –Ω–µ—Ç –∂–∞–ª–æ–±, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–µ–º–æ
        if (allReports.length === 0) {
          allReports = generateDemoReports(8);
          console.log('‚úÖ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ –¥–µ–º–æ-–∂–∞–ª–æ–±:', allReports.length);
        }
      } catch (e) {
        console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∂–∞–ª–æ–±:', e);
        allReports = generateDemoReports(5);
      }
    }

    // –ù–û–í–ê–Ø –§–£–ù–ö–¶–ò–Ø: –ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ –±–æ–Ω—É—Å–æ–≤
    function loadBonuses() {
      try {
        // –ü—ã—Ç–∞–µ–º—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ localStorage
        const saved = localStorage.getItem('siamatch_admin_bonuses');
        if (saved) {
          allBonuses = JSON.parse(saved);
          console.log('üìÇ –ó–∞–≥—Ä—É–∂–µ–Ω–æ –±–æ–Ω—É—Å–æ–≤ –∏–∑ localStorage:', allBonuses.length);
        }
        
        // –ï—Å–ª–∏ –Ω–µ—Ç –±–æ–Ω—É—Å–æ–≤, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–µ–º–æ
        if (allBonuses.length === 0) {
          allBonuses = generateDemoBonuses(20);
          console.log('‚úÖ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ –¥–µ–º–æ-–±–æ–Ω—É—Å–æ–≤:', allBonuses.length);
        }
      } catch (e) {
        console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±–æ–Ω—É—Å–æ–≤:', e);
        allBonuses = generateDemoBonuses(10);
      }
    }

    // –ù–û–í–ê–Ø –§–£–ù–ö–¶–ò–Ø: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –±–æ–Ω—É—Å–æ–≤
    function saveBonuses() {
      try {
        localStorage.setItem('siamatch_admin_bonuses', JSON.stringify(allBonuses));
      } catch (e) {
        console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –±–æ–Ω—É—Å–æ–≤:', e);
      }
    }

    // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
    function showVerificationModal(user) {
      modalContent.innerHTML = `
        <div class="photo-comparison">
          <div class="photo-container">
            <div class="photo-label">–§–æ—Ç–æ –≤ –ø—Ä–æ—Ñ–∏–ª–µ</div>
            <img src="${user.profile_photo}" alt="–§–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª—è" class="verification-photo" />
          </div>
          <div class="photo-container">
            <div class="photo-label">–°–µ–ª—Ñ–∏ –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏</div>
            <img src="${user.verification_photo}" alt="–°–µ–ª—Ñ–∏" class="verification-photo" />
          </div>
        </div>
        <div style="margin-bottom: 16px;">
          <strong>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ:</strong><br>
          ID: ${user.id}<br>
          –ò–º—è: ${user.name}, ${user.age} –ª–µ—Ç<br>
          Username: @${user.username}<br>
          –ì–æ—Ä–æ–¥: ${user.city}<br>
          –î–∞—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞: ${user.verification_request_date ? new Date(user.verification_request_date).toLocaleString() : '–ù–µ —É–∫–∞–∑–∞–Ω–∞'}
        </div>
        <div class="modal-actions">
          <button id="approve-verification-btn" class="primary">‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é</button>
          <button id="reject-verification-btn" class="primary danger-btn">‚ùå –û—Ç–∫–ª–æ–Ω–∏—Ç—å</button>
        </div>
      `;
      
      verificationModal.classList.remove('hidden');
      
      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ
      document.getElementById('approve-verification-btn').onclick = () => {
        approveVerification(user.id);
        verificationModal.classList.add('hidden');
      };
      
      document.getElementById('reject-verification-btn').onclick = () => {
        rejectVerification(user.id);
        verificationModal.classList.add('hidden');
      };
    }

    // –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é
    function approveVerification(userId) {
      const user = allUsers.find(u => u.id === userId);
      if (user) {
        user.verified = true;
        user.verification_status = 'verified';
        
        // –ù–ê–ß–ò–°–õ–Ø–ï–ú –ë–û–ù–£–° –ó–ê –í–ï–†–ò–§–ò–ö–ê–¶–ò–Æ
        const bonusSwipes = 20;
        user.remaining_swipes = (user.remaining_swipes || 0) + bonusSwipes;
        user.bonus_swipes = (user.bonus_swipes || 0) + bonusSwipes;
        
        // –î–û–ë–ê–í–õ–Ø–ï–ú –í –ò–°–¢–û–†–ò–Æ –ë–û–ù–£–°–û–í
        const newBonus = {
          id: allBonuses.length + 1,
          userId: user.id,
          userName: user.name,
          type: 'verification',
          typeName: '–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∞–Ω–∫–µ—Ç—ã',
          icon: 'üîê',
          details: `+${bonusSwipes} —Å–≤–∞–π–ø–æ–≤`,
          swipes: bonusSwipes,
          boostHours: 0,
          reason: 'verification_success',
          reasonText: '–£—Å–ø–µ—à–Ω–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è',
          comment: '–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ –∑–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é',
          adminName: '–°–∏—Å—Ç–µ–º–∞',
          createdAt: new Date().toISOString(),
          status: 'completed'
        };
        allBonuses.push(newBonus);
        saveBonuses();
        
        alert(`‚úÖ –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–ª—è ${user.name} –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞!\n\n–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∏–ª +${bonusSwipes} —Å–≤–∞–π–ø–æ–≤ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –±–æ–Ω—É—Å–∞!`);
        switchTab(currentTab);
        updateStats();
      }
    }

    // –û—Ç–∫–ª–æ–Ω–∏—Ç—å –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é
    function rejectVerification(userId) {
      const user = allUsers.find(u => u.id === userId);
      if (user) {
        user.verified = false;
        user.verification_status = 'rejected';
        alert(`‚ùå –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–ª—è ${user.name} –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞.\n\n–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–º–æ–∂–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–µ–ª—Ñ–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏.`);
        switchTab(currentTab);
        updateStats();
      }
    }

    // –ù–û–í–ê–Ø –§–£–ù–ö–¶–ò–Ø: –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –±–æ–Ω—É—Å–æ–≤
    function showBonusModal(user) {
      currentUserForBonus = user;
      
      document.getElementById('bonus-user-id').textContent = user.id;
      document.getElementById('bonus-user-name').textContent = `${user.name}, ${user.age} –ª–µ—Ç`;
      
      // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è
      bonusTypeSelect.value = 'verification';
      customBonusAmountDiv.classList.add('hidden');
      customBoostHoursDiv.classList.add('hidden');
      bonusReasonSelect.value = 'verification_success';
      bonusCommentInput.value = '';
      
      bonusModal.classList.remove('hidden');
    }

    // –ù–û–í–ê–Ø –§–£–ù–ö–¶–ò–Ø: –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏—Å—Ç–æ—Ä–∏–∏ –±–æ–Ω—É—Å–æ–≤
    function showBonusHistoryModal(user) {
      currentUserForBonusHistory = user;
      
      // –§–∏–ª—å—Ç—Ä—É–µ–º –±–æ–Ω—É—Å—ã –¥–ª—è —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      const userBonuses = allBonuses.filter(b => b.userId === user.id);
      
      let bonusesHtml = '';
      if (userBonuses.length === 0) {
        bonusesHtml = `<div style="text-align: center; padding: 20px; color: var(--muted);">
          <div style="font-size: 40px; margin-bottom: 10px;">üéÅ</div>
          <div>–£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ–∫–∞ –Ω–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏ –±–æ–Ω—É—Å–æ–≤</div>
        </div>`;
      } else {
        // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –¥–∞—Ç–µ (–Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É)
        userBonuses.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
        
        userBonuses.forEach(bonus => {
          bonusesHtml += `
            <div class="bonus-record">
              <div class="bonus-record-header">
                <div class="bonus-record-type">
                  ${bonus.icon} ${bonus.typeName}
                </div>
                <div class="bonus-record-date">
                  ${new Date(bonus.createdAt).toLocaleDateString()}
                </div>
              </div>
              <div class="bonus-record-details">
                ${bonus.details}<br>
                –ü—Ä–∏—á–∏–Ω–∞: ${bonus.reasonText}<br>
                ${bonus.comment ? `–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: ${bonus.comment}<br>` : ''}
                –ù–∞—á–∏—Å–ª–∏–ª: ${bonus.adminName}
              </div>
            </div>
          `;
        });
      }
      
      bonusHistoryContent.innerHTML = `
        <div style="margin-bottom: 16px;">
          <strong>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:</strong> ${user.name}, ${user.age} –ª–µ—Ç (ID: ${user.id})<br>
          <strong>–í—Å–µ–≥–æ –±–æ–Ω—É—Å–æ–≤:</strong> ${userBonuses.length}
        </div>
        <div style="max-height: 400px; overflow-y: auto;">
          ${bonusesHtml}
        </div>
      `;
      
      bonusHistoryModal.classList.remove('hidden');
    }

    // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –±—É—Å—Ç–∞
    function showBoostModal(user) {
      currentUserForBoost = user;
      
      document.getElementById('boost-user-id').textContent = user.id;
      document.getElementById('boost-user-name').textContent = `${user.name}, ${user.age} –ª–µ—Ç`;
      
      boostDurationSelect.value = '24';
      customBoostDuration.classList.add('hidden');
      customDaysInput.value = '7';
      boostReasonInput.value = '';
      
      boostModal.classList.remove('hidden');
    }

    // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–≤–∞–π–ø–æ–≤
    function showSwipesModal(user) {
      currentUserForSwipes = user;
      
      document.getElementById('swipes-user-id').textContent = user.id;
      document.getElementById('swipes-user-name').textContent = `${user.name}, ${user.age} –ª–µ—Ç`;
      
      customSwipesInput.value = '50';
      swipesReasonInput.value = '';
      
      // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
      document.querySelectorAll('.swipe-amount-btn').forEach(btn => {
        btn.classList.remove('active');
        if (btn.dataset.amount === '50') {
          btn.classList.add('active');
        }
      });
      
      swipesModal.classList.remove('hidden');
    }

    // –ù–û–í–ê–Ø –§–£–ù–ö–¶–ò–Ø: –ü—Ä–∏–º–µ–Ω–∏—Ç—å –±–æ–Ω—É—Å
    function applyBonus() {
      if (!currentUserForBonus) return;
      
      const user = allUsers.find(u => u.id === currentUserForBonus.id);
      if (!user) return;
      
      const bonusType = bonusTypeSelect.value;
      const reason = bonusReasonSelect.value;
      const comment = bonusCommentInput.value.trim();
      
      let bonusDetails = '';
      let bonusSwipes = 0;
      let bonusBoostHours = 0;
      let bonusName = '';
      let bonusIcon = '';
      
      // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –±–æ–Ω—É—Å–∞
      switch(bonusType) {
        case 'verification':
          bonusSwipes = 20;
          bonusName = '–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∞–Ω–∫–µ—Ç—ã';
          bonusIcon = 'üîê';
          bonusDetails = `+${bonusSwipes} —Å–≤–∞–π–ø–æ–≤`;
          break;
          
        case 'invite':
          bonusSwipes = 20;
          bonusName = '–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –¥—Ä—É–≥–∞';
          bonusIcon = 'üë•';
          bonusDetails = `+${bonusSwipes} —Å–≤–∞–π–ø–æ–≤`;
          user.invited_friends = (user.invited_friends || 0) + 1;
          break;
          
        case 'share':
          bonusBoostHours = 24;
          bonusName = '–®–µ—Ä–∏–Ω–≥ –≤ Stories';
          bonusIcon = 'üì±';
          bonusDetails = `–ë—É—Å—Ç –Ω–∞ ${bonusHours} —á–∞—Å–æ–≤`;
          user.shared_stories = (user.shared_stories || 0) + 1;
          break;
          
        case 'custom_swipes':
          bonusSwipes = parseInt(customBonusAmountInput.value) || 20;
          bonusName = '–ë–æ–Ω—É—Å–Ω—ã–µ —Å–≤–∞–π–ø—ã';
          bonusIcon = 'üîÑ';
          bonusDetails = `+${bonusSwipes} —Å–≤–∞–π–ø–æ–≤`;
          break;
          
        case 'custom_boost':
          bonusBoostHours = parseInt(customBoostHoursInput.value) || 24;
          bonusName = '–ë–æ–Ω—É—Å–Ω—ã–π –±—É—Å—Ç';
          bonusIcon = 'üöÄ';
          bonusDetails = `–ë—É—Å—Ç –Ω–∞ ${bonusBoostHours} —á–∞—Å–æ–≤`;
          break;
          
        case 'other':
          bonusSwipes = 10; // –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
          bonusName = '–î—Ä—É–≥–æ–π –±–æ–Ω—É—Å';
          bonusIcon = 'üéÅ';
          bonusDetails = `–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –±–æ–Ω—É—Å`;
          break;
      }
      
      // –ü—Ä–∏–º–µ–Ω—è–µ–º –±–æ–Ω—É—Å –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
      if (bonusSwipes > 0) {
        user.remaining_swipes = (user.remaining_swipes || 0) + bonusSwipes;
        user.bonus_swipes = (user.bonus_swipes || 0) + bonusSwipes;
      }
      
      if (bonusBoostHours > 0) {
        user.boosted = true;
        const boostEndTime = new Date(Date.now() + (bonusBoostHours * 60 * 60 * 1000));
        user.boost_end = boostEndTime.toISOString();
      }
      
      // –î–æ–±–∞–≤–ª—è–µ–º –±–æ–Ω—É—Å –≤ –∏—Å—Ç–æ—Ä–∏—é
      const newBonus = {
        id: allBonuses.length + 1,
        userId: user.id,
        userName: user.name,
        type: bonusType,
        typeName: bonusName,
        icon: bonusIcon,
        details: bonusDetails,
        swipes: bonusSwipes,
        boostHours: bonusBoostHours,
        reason: reason,
        reasonText: getReasonText(reason),
        comment: comment || '',
        adminName: '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä',
        createdAt: new Date().toISOString(),
        status: 'completed'
      };
      
      allBonuses.push(newBonus);
      saveBonuses();
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
      let successMessage = `‚úÖ –ë–æ–Ω—É—Å —É—Å–ø–µ—à–Ω–æ –Ω–∞—á–∏—Å–ª–µ–Ω!\n\n`;
      successMessage += `–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${user.name}\n`;
      successMessage += `–¢–∏–ø –±–æ–Ω—É—Å–∞: ${bonusName}\n`;
      if (bonusSwipes > 0) {
        successMessage += `–°–≤–∞–π–ø–æ–≤: +${bonusSwipes}\n`;
        successMessage += `–í—Å–µ–≥–æ —Å–≤–∞–π–ø–æ–≤: ${user.remaining_swipes}\n`;
      }
      if (bonusBoostHours > 0) {
        successMessage += `–ë—É—Å—Ç: ${bonusBoostHours} —á–∞—Å–æ–≤\n`;
      }
      if (comment) {
        successMessage += `–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: ${comment}\n`;
      }
      
      alert(successMessage);
      
      // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
      bonusModal.classList.add('hidden');
      currentUserForBonus = null;
      updateStats();
      
      if (currentTab === 'bonuses') {
        renderBonusUsers();
      } else {
        switchTab(currentTab);
      }
    }

    // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –ø—Ä–∏—á–∏–Ω—ã
    function getReasonText(reasonCode) {
      const reasons = {
        'verification_success': '–£—Å–ø–µ—à–Ω–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è',
        'invite_friend': '–ü—Ä–∏–≥–ª–∞—Å–∏–ª –¥—Ä—É–≥–∞',
        'shared_stories': '–ü–æ–¥–µ–ª–∏–ª—Å—è –≤ Stories',
        'promo': '–ü—Ä–æ–º–æ-–∞–∫—Ü–∏—è',
        'compensation': '–ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è',
        'loyalty': '–õ–æ—è–ª—å–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è',
        'other': '–î—Ä—É–≥–æ–µ'
      };
      return reasons[reasonCode] || '–î—Ä—É–≥–æ–µ';
    }

    // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–µ—Ç–∞–ª–µ–π –∂–∞–ª–æ–±—ã
    function showReportDetails(report) {
      currentReportForDetails = report;
      
      reportDetailsId.textContent = report.id;
      
      // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –∏ —Ü–≤–µ—Ç
      const statusInfo = {
        'pending': { text: '–ù–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏', color: 'var(--warning)', icon: '‚ö†Ô∏è' },
        'reviewing': { text: '–í –ø—Ä–æ—Ü–µ—Å—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏', color: 'var(--info)', icon: 'üîç' },
        'resolved': { text: '–†–µ—à–µ–Ω–æ', color: '#10b981', icon: '‚úÖ' },
        'rejected': { text: '–û—Ç–∫–ª–æ–Ω–µ–Ω–æ', color: 'var(--danger)', icon: '‚ùå' }
      }[report.status];
      
      // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º HTML –¥–ª—è –¥–µ—Ç–∞–ª–µ–π –∂–∞–ª–æ–±—ã
      let messagesHtml = '';
      if (report.chatMessages && report.chatMessages.length > 0) {
        report.chatMessages.forEach(msg => {
          const isReporter = msg.sender === 'reporter';
          messagesHtml += `
            <div class="chat-message ${isReporter ? 'reporter' : 'reported'}">
              <div class="message-sender">${isReporter ? report.reporterName : report.reportedUserName}</div>
              <div class="message-text">${msg.text}</div>
              <div class="message-time">${msg.date} ${msg.time}</div>
            </div>
          `;
        });
      } else {
        messagesHtml = `<div class="chat-message-system">–ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –¥–∏–∞–ª–æ–≥–µ</div>`;
      }
      
      reportDetailsContent.innerHTML = `
        <div class="report-section">
          <div class="report-section-title">
            ${statusInfo.icon} –°—Ç–∞—Ç—É—Å: <span style="color: ${statusInfo.color}">${statusInfo.text}</span>
          </div>
          <div style="font-size: 13px; color: var(--muted);">
            –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è: ${new Date(report.createdAt).toLocaleString()}<br>
            ${report.resolvedAt ? `–î–∞—Ç–∞ —Ä–µ—à–µ–Ω–∏—è: ${new Date(report.resolvedAt).toLocaleString()}<br>` : ''}
            ${report.adminResponse ? `–û—Ç–≤–µ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞: ${report.adminResponse}` : ''}
          </div>
        </div>
        
        <div class="report-section">
          <div class="report-section-title">üë• –£—á–∞—Å—Ç–Ω–∏–∫–∏ –∂–∞–ª–æ–±—ã</div>
          <div class="report-user-info">
            <div class="report-user-card">
              <div class="report-user-name">${report.reporterName} (–ò–Ω–∏—Ü–∏–∞—Ç–æ—Ä)</div>
              <div class="report-user-details">
                ID: ${report.reporterId}<br>
                –í–æ–∑—Ä–∞—Å—Ç: ${report.reporterProfile?.age || '–Ω–µ —É–∫–∞–∑–∞–Ω'}<br>
                –ì–æ—Ä–æ–¥: ${report.reporterProfile?.city || '–Ω–µ —É–∫–∞–∑–∞–Ω'}<br>
                –ü–æ–ª: ${report.reporterProfile?.gender === 'male' ? '–ú—É–∂—Å–∫–æ–π' : '–ñ–µ–Ω—Å–∫–∏–π'}<br>
                –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è: ${report.reporterProfile?.verified ? '‚úÖ' : '‚ùå'}
              </div>
            </div>
            <div class="report-user-card">
              <div class="report-user-name">${report.reportedUserName} (–ù–∞ –∫–æ–≥–æ –ø–æ–∂–∞–ª–æ–≤–∞–ª–∏—Å—å)</div>
              <div class="report-user-details">
                ID: ${report.reportedUserId}<br>
                –í–æ–∑—Ä–∞—Å—Ç: ${report.reportedUserProfile?.age || '–Ω–µ —É–∫–∞–∑–∞–Ω'}<br>
                –ì–æ—Ä–æ–¥: ${report.reportedUserProfile?.city || '–Ω–µ —É–∫–∞–∑–∞–Ω'}<br>
                –ü–æ–ª: ${report.reportedUserProfile?.gender === 'male' ? '–ú—É–∂—Å–∫–æ–π' : '–ñ–µ–Ω—Å–∫–∏–π'}<br>
                –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è: ${report.reportedUserProfile?.verified ? '‚úÖ' : '‚ùå'}
              </div>
            </div>
          </div>
        </div>
        
        <div class="report-section">
          <div class="report-section-title">üìù –ü—Ä–∏—á–∏–Ω–∞ –∂–∞–ª–æ–±—ã</div>
          <div style="padding: 12px; background: rgba(2, 6, 23, 0.7); border-radius: 8px;">
            <strong>–¢–∏–ø:</strong> ${report.reason}<br>
            ${report.additionalInfo ? `<strong>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:</strong> ${report.additionalInfo}` : ''}
          </div>
        </div>
        
        <div class="report-section">
          <div class="report-section-title">üí¨ –î–∏–∞–ª–æ–≥ (${report.chatMessages?.length || 0} —Å–æ–æ–±—â–µ–Ω–∏–π)</div>
          <div class="chat-messages-list">
            ${messagesHtml}
          </div>
        </div>
        
        <div class="report-actions">
          ${report.status === 'pending' ? `
            <button id="start-review-btn" class="primary">üîç –ù–∞—á–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É</button>
            <button id="reject-report-btn" class="primary danger-btn">‚ùå –û—Ç–∫–ª–æ–Ω–∏—Ç—å</button>
          ` : ''}
          
          ${report.status === 'reviewing' ? `
            <button id="resolve-report-btn" class="primary">‚úÖ –†–µ—à–∏—Ç—å</button>
            <button id="reject-report-btn" class="primary danger-btn">‚ùå –û—Ç–∫–ª–æ–Ω–∏—Ç—å</button>
          ` : ''}
          
          ${report.status === 'resolved' || report.status === 'rejected' ? `
            <button id="reopen-report-btn" class="primary">üîÑ –ü–µ—Ä–µ–æ—Ç–∫—Ä—ã—Ç—å</button>
          ` : ''}
          
          <button id="block-reported-btn" class="primary danger-btn">üö´ –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
        </div>
      `;
      
      reportDetailsModal.classList.remove('hidden');
      
      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫
      if (document.getElementById('start-review-btn')) {
        document.getElementById('start-review-btn').onclick = () => {
          startReviewReport(report.id);
        };
      }
      
      if (document.getElementById('resolve-report-btn')) {
        document.getElementById('resolve-report-btn').onclick = () => {
          resolveReport(report.id);
        };
      }
      
      if (document.getElementById('reject-report-btn')) {
        document.getElementById('reject-report-btn').onclick = () => {
          rejectReport(report.id);
        };
      }
      
      if (document.getElementById('reopen-report-btn')) {
        document.getElementById('reopen-report-btn').onclick = () => {
          reopenReport(report.id);
        };
      }
      
      document.getElementById('block-reported-btn').onclick = () => {
        blockReportedUser(report.reportedUserId);
      };
    }

    // –ù–∞—á–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∂–∞–ª–æ–±—ã
    function startReviewReport(reportId) {
      const report = allReports.find(r => r.id === reportId);
      if (report) {
        report.status = 'reviewing';
        reportDetailsModal.classList.add('hidden');
        switchTab('reports');
        showNotification(`üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∂–∞–ª–æ–±—ã #${reportId} –Ω–∞—á–∞—Ç–∞`);
      }
    }

    // –†–µ—à–∏—Ç—å –∂–∞–ª–æ–±—É
    function resolveReport(reportId) {
      const report = allReports.find(r => r.id === reportId);
      if (report) {
        const response = prompt('–í–≤–µ–¥–∏—Ç–µ –æ—Ç–≤–µ—Ç –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):', '–ñ–∞–ª–æ–±–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∞, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω');
        report.status = 'resolved';
        report.adminResponse = response || '–ñ–∞–ª–æ–±–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∞, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω';
        report.resolvedAt = new Date().toISOString();
        reportDetailsModal.classList.add('hidden');
        switchTab('reports');
        showNotification(`‚úÖ –ñ–∞–ª–æ–±–∞ #${reportId} —Ä–µ—à–µ–Ω–∞`);
      }
    }

    // –û—Ç–∫–ª–æ–Ω–∏—Ç—å –∂–∞–ª–æ–±—É
    function rejectReport(reportId) {
      const report = allReports.find(r => r.id === reportId);
      if (report) {
        const response = prompt('–í–≤–µ–¥–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):', '–ñ–∞–ª–æ–±–∞ –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª–∞—Å—å');
        report.status = 'rejected';
        report.adminResponse = response || '–ñ–∞–ª–æ–±–∞ –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª–∞—Å—å';
        report.resolvedAt = new Date().toISOString();
        reportDetailsModal.classList.add('hidden');
        switchTab('reports');
        showNotification(`‚ùå –ñ–∞–ª–æ–±–∞ #${reportId} –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞`);
      }
    }

    // –ü–µ—Ä–µ–æ—Ç–∫—Ä—ã—Ç—å –∂–∞–ª–æ–±—É
    function reopenReport(reportId) {
      const report = allReports.find(r => r.id === reportId);
      if (report) {
        report.status = 'pending';
        report.adminResponse = null;
        report.resolvedAt = null;
        reportDetailsModal.classList.add('hidden');
        switchTab('reports');
        showNotification(`üîÑ –ñ–∞–ª–æ–±–∞ #${reportId} –ø–µ—Ä–µ–æ—Ç–∫—Ä—ã—Ç–∞`);
      }
    }

    // –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –∂–∞–ª–æ–±—ã
    function blockReportedUser(userId) {
      const user = allUsers.find(u => u.id === userId);
      if (user) {
        user.blocked = true;
        user.is_new = false;
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Å–µ –∂–∞–ª–æ–±—ã –Ω–∞ —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        allReports.forEach(report => {
          if (report.reportedUserId === userId && report.status !== 'resolved' && report.status !== 'rejected') {
            report.status = 'resolved';
            report.adminResponse = '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω';
            report.resolvedAt = new Date().toISOString();
          }
        });
        
        reportDetailsModal.classList.add('hidden');
        switchTab('reports');
        updateStats();
        
        showNotification(`üö´ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${user.name} –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω!\n\n–í—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –∂–∞–ª–æ–±—ã –Ω–∞ –Ω–µ–≥–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–µ—à–µ–Ω—ã.`);
      }
    }

    // –ü—Ä–∏–º–µ–Ω–∏—Ç—å –±—É—Å—Ç
    function applyBoost() {
      if (!currentUserForBoost) return;
      
      let hours = 24;
      if (boostDurationSelect.value === 'custom') {
        const days = parseInt(customDaysInput.value) || 7;
        hours = days * 24;
      } else {
        hours = parseInt(boostDurationSelect.value);
      }
      
      const reason = boostReasonInput.value.trim();
      
      // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –¥–µ–º–æ-–¥–∞–Ω–Ω—ã—Ö
      const user = allUsers.find(u => u.id === currentUserForBoost.id);
      if (user) {
        user.boosted = true;
        user.boost_end = new Date(Date.now() + (hours * 60 * 60 * 1000)).toISOString();
        
        let message = `‚úÖ –ë—É—Å—Ç –∞–Ω–∫–µ—Ç—ã –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!\n\n`;
        message += `–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${user.name}\n`;
        message += `–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: ${hours} —á–∞—Å–æ–≤ (${Math.round(hours/24)} –¥–Ω–µ–π)\n`;
        if (reason) message += `–ü—Ä–∏—á–∏–Ω–∞: ${reason}\n`;
        message += `\n–ê–Ω–∫–µ—Ç–∞ –±—É–¥–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å—Å—è —á–∞—â–µ –≤ –ª–µ–Ω—Ç–µ –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.`;
        
        alert(message);
        
        switchTab(currentTab);
        updateStats();
        boostModal.classList.add('hidden');
        currentUserForBoost = null;
      }
    }

    // –ü–æ–¥–∞—Ä–∏—Ç—å —Å–≤–∞–π–ø—ã
    function applySwipes() {
      if (!currentUserForSwipes) return;
      
      let swipesCount = parseInt(customSwipesInput.value) || 50;
      if (swipesCount < 1) swipesCount = 1;
      if (swipesCount > 1000) swipesCount = 1000;
      
      const reason = swipesReasonInput.value.trim();
      
      const user = allUsers.find(u => u.id === currentUserForSwipes.id);
      if (user) {
        user.remaining_swipes = (user.remaining_swipes || 0) + swipesCount;
        user.bonus_swipes = (user.bonus_swipes || 0) + swipesCount;
        
        let message = `‚úÖ –°–≤–∞–π–ø—ã –ø–æ–¥–∞—Ä–µ–Ω—ã!\n\n`;
        message += `–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${user.name}\n`;
        message += `–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: ${swipesCount} —Å–≤–∞–π–ø–æ–≤\n`;
        message += `–í—Å–µ–≥–æ —Å–≤–∞–π–ø–æ–≤: ${user.remaining_swipes}\n`;
        if (reason) message += `–ü—Ä–∏—á–∏–Ω–∞: ${reason}\n`;
        message += `\n–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∏—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø–æ–¥–∞—Ä–∫–µ.`;
        
        alert(message);
        
        swipesModal.classList.add('hidden');
        currentUserForSwipes = null;
      }
    }

    // –ù–û–í–ê–Ø –§–£–ù–ö–¶–ò–Ø: –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –≤–∫–ª–∞–¥–∫–∏ –±–æ–Ω—É—Å–æ–≤
    function renderBonusUsers() {
      usersList.innerHTML = "";
      
      // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –±–æ–Ω—É—Å–Ω—ã—Ö –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π
      const sortedUsers = [...allUsers].sort((a, b) => {
        const aScore = (a.bonus_swipes || 0) + (a.invited_friends || 0) * 10 + (a.shared_stories || 0) * 5;
        const bScore = (b.bonus_swipes || 0) + (b.invited_friends || 0) * 10 + (b.shared_stories || 0) * 5;
        return bScore - aScore;
      });
      
      if (!sortedUsers.length) {
        resultsInfo.textContent = "–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö";
        return;
      }
      
      resultsInfo.textContent = `–ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏: ${sortedUsers.length} —á–µ–ª–æ–≤–µ–∫`;
      
      // –†–µ–Ω–¥–µ—Ä–∏–º –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      sortedUsers.forEach((u) => {
        const li = document.createElement("li");
        
        // –ö–ª–∞—Å—Å—ã –¥–ª—è —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏
        const classes = ['user-item', 'bonus-item'];
        if (u.blocked) classes.push('blocked');
        if (u.is_new) classes.push('new');
        classes.push(u.verification_status);
        if (u.boosted) classes.push('boosted');
        li.className = classes.join(' ');

        const main = document.createElement("div");
        main.className = "user-main";
        
        // –ë–µ–π–¥–∂ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
        const verificationBadgeText = {
          'not_verified': '–ù–µ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω',
          'pending': '‚è≥ –ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ',
          'verified': '‚úÖ –í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω',
          'rejected': '‚ùå –û—Ç–∫–ª–æ–Ω–µ–Ω'
        }[u.verification_status];
        
        // –ë–µ–π–¥–∂ –±—É—Å—Ç–∞
        const boostBadge = u.boosted ? 
          `<span class="boost-badge">üöÄ –ë—É—Å—Ç –¥–æ: ${new Date(u.boost_end).toLocaleDateString()}</span>` : '';
        
        // –ë–æ–Ω—É—Å–Ω—ã–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
        const bonusBadge = `
          <span class="bonus-badge">üéÅ ${u.total_bonuses || 0} –±–æ–Ω—É—Å–æ–≤</span>
        `;
        
        main.innerHTML = `
          <div class="user-name">
            ${u.name}, ${u.age} –ª–µ—Ç
            <span class="verification-badge ${u.verification_status}">${verificationBadgeText}</span>
            ${boostBadge}
            ${bonusBadge}
          </div>
          <div class="user-meta">
            <span>ID: ${u.id}</span>
            <span>@${u.username}</span>
            <span>${u.city}</span>
            <span>üîÑ ${u.remaining_swipes || 0} —Å–≤–∞–π–ø–æ–≤</span>
            <span style="color: var(--invite)">üë• ${u.invited_friends || 0} –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π</span>
            <span style="color: var(--share)">üì± ${u.shared_stories || 0} —à–µ—Ä–æ–≤</span>
            <span style="color: #10b981">üéÅ ${u.bonus_swipes || 0} –±–æ–Ω—É—Å–Ω—ã—Ö —Å–≤–∞–π–ø–æ–≤</span>
            ${u.blocked ? '<span style="color:var(--danger)">üö´ –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω</span>' : ''}
            ${u.is_new ? '<span style="color:var(--info)">üÜï –ù–æ–≤—ã–π</span>' : ''}
          </div>
        `;

        const actions = document.createElement("div");
        actions.className = "user-actions";
        
        const actionsRow1 = document.createElement("div");
        actionsRow1.className = "user-actions-row";
        
        const actionsRow2 = document.createElement("div");
        actionsRow2.className = "user-actions-row";

        // –ö–Ω–æ–ø–∫–∞ "–ò—Å—Ç–æ—Ä–∏—è –±–æ–Ω—É—Å–æ–≤"
        const historyBtn = document.createElement("button");
        historyBtn.className = "bonus-btn-admin";
        historyBtn.innerHTML = "üìã –ò—Å—Ç–æ—Ä–∏—è –±–æ–Ω—É—Å–æ–≤";
        historyBtn.onclick = () => {
          showBonusHistoryModal(u);
        };
        actionsRow1.appendChild(historyBtn);

        // –ö–Ω–æ–ø–∫–∞ "–ù–∞—á–∏—Å–ª–∏—Ç—å –±–æ–Ω—É—Å"
        const addBonusBtn = document.createElement("button");
        addBonusBtn.className = "bonus-btn-admin";
        addBonusBtn.innerHTML = "üéÅ –ù–∞—á–∏—Å–ª–∏—Ç—å –±–æ–Ω—É—Å";
        addBonusBtn.onclick = () => {
          showBonusModal(u);
        };
        actionsRow1.appendChild(addBonusBtn);

        // –ö–Ω–æ–ø–∫–∞ "–ü–æ–¥–∞—Ä–∏—Ç—å —Å–≤–∞–π–ø—ã"
        const swipesBtn = document.createElement("button");
        swipesBtn.className = "swipes-btn-admin";
        swipesBtn.innerHTML = "üîÑ –ü–æ–¥–∞—Ä–∏—Ç—å —Å–≤–∞–π–ø—ã";
        swipesBtn.onclick = () => {
          showSwipesModal(u);
        };
        actionsRow2.appendChild(swipesBtn);

        // –ö–Ω–æ–ø–∫–∞ –±—É—Å—Ç–∞
        const boostBtn = document.createElement("button");
        boostBtn.className = "boost-btn-admin";
        boostBtn.innerHTML = u.boosted ? "üîÑ –ü—Ä–æ–¥–ª–∏—Ç—å –±—É—Å—Ç" : "üöÄ –ë—É—Å—Ç –∞–Ω–∫–µ—Ç—ã";
        boostBtn.onclick = () => {
          showBoostModal(u);
        };
        actionsRow2.appendChild(boostBtn);

        actions.appendChild(actionsRow1);
        actions.appendChild(actionsRow2);
        li.appendChild(main);
        li.appendChild(actions);
        usersList.appendChild(li);
      });
    }

    // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –≤–∫–ª–∞–¥–æ–∫
    function renderUsers(users) {
      usersList.innerHTML = "";
      
      if (!users.length) {
        const emptyMsg = {
          "all": "–ù–µ—Ç –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π",
          "new": "–ù–µ—Ç –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞",
          "verification": "–ù–µ—Ç –∑–∞—è–≤–æ–∫ –Ω–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏",
          "blocked": "–ù–µ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π",
          "search": "–ü–æ –≤–∞—à–µ–º—É –∑–∞–ø—Ä–æ—Å—É –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ"
        }[currentTab];
        
        resultsInfo.textContent = emptyMsg;
        return;
      }
      
      // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö
      const tabTitles = {
        "all": "–í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
        "new": "–ù–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
        "verification": "–ó–∞—è–≤–∫–∏ –Ω–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é",
        "blocked": "–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
        "search": "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞"
      };
      
      resultsInfo.textContent = `${tabTitles[currentTab]}: ${users.length} –∞–Ω–∫–µ—Ç`;
      
      // –†–µ–Ω–¥–µ—Ä–∏–º –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      users.forEach((u) => {
        const li = document.createElement("li");
        
        // –ö–ª–∞—Å—Å—ã –¥–ª—è —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏
        const classes = ['user-item'];
        if (u.blocked) classes.push('blocked');
        if (u.is_new) classes.push('new');
        classes.push(u.verification_status);
        if (u.boosted) classes.push('boosted');
        li.className = classes.join(' ');

        const main = document.createElement("div");
        main.className = "user-main";
        
        // –ë–µ–π–¥–∂ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
        const verificationBadgeText = {
          'not_verified': '–ù–µ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω',
          'pending': '‚è≥ –ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ',
          'verified': '‚úÖ –í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω',
          'rejected': '‚ùå –û—Ç–∫–ª–æ–Ω–µ–Ω'
        }[u.verification_status];
        
        // –ë–µ–π–¥–∂ –±—É—Å—Ç–∞
        const boostBadge = u.boosted ? 
          `<span class="boost-badge">üöÄ –ë—É—Å—Ç –¥–æ: ${new Date(u.boost_end).toLocaleDateString()}</span>` : '';
        
        // –ë–æ–Ω—É—Å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
        const bonusInfo = u.bonus_swipes ? 
          `<span style="color:#10b981;">üéÅ ${u.bonus_swipes} –±–æ–Ω—É—Å–Ω—ã—Ö —Å–≤–∞–π–ø–æ–≤</span>` : '';
        
        main.innerHTML = `
          <div class="user-name">
            ${u.name}, ${u.age} –ª–µ—Ç
            <span class="verification-badge ${u.verification_status}">${verificationBadgeText}</span>
            ${boostBadge}
          </div>
          <div class="user-meta">
            <span>ID: ${u.id}</span>
            <span>@${u.username}</span>
            <span>${u.city}</span>
            <span>${u.gender === 'male' ? '‚ôÇ –ú—É–∂—Å–∫–æ–π' : '‚ôÄ –ñ–µ–Ω—Å–∫–∏–π'}</span>
            <span>–†–µ–≥.: ${u.registration_date}</span>
            <span>üîÑ ${u.remaining_swipes || 0} —Å–≤–∞–π–ø–æ–≤</span>
            ${bonusInfo}
            ${u.blocked ? '<span style="color:var(--danger)">üö´ –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω</span>' : ''}
            ${u.is_new ? '<span style="color:var(--info)">üÜï –ù–æ–≤—ã–π</span>' : ''}
          </div>
        `;

        const actions = document.createElement("div");
        actions.className = "user-actions";
        
        const actionsRow1 = document.createElement("div");
        actionsRow1.className = "user-actions-row";
        
        const actionsRow2 = document.createElement("div");
        actionsRow2.className = "user-actions-row";

        // –ö–Ω–æ–ø–∫–∞ "–û—Ç–∫—Ä—ã—Ç—å –≤ TG"
        if (u.username && u.username !== 'undefined') {
          const openBtn = document.createElement("button");
          openBtn.className = "link-btn";
          openBtn.textContent = "–û—Ç–∫—Ä—ã—Ç—å –≤ TG";
          openBtn.onclick = () => {
            window.open("https://t.me/" + u.username, "_blank");
          };
          actionsRow1.appendChild(openBtn);
        }

        // –ö–Ω–æ–ø–∫–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è pending)
        if (u.verification_status === 'pending') {
          const verifyBtn = document.createElement("button");
          verifyBtn.className = "verify-btn";
          verifyBtn.textContent = "üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å";
          verifyBtn.onclick = () => {
            showVerificationModal(u);
          };
          actionsRow1.appendChild(verifyBtn);
        }

        // –ö–Ω–æ–ø–∫–∞ –±—É—Å—Ç–∞
        const boostBtn = document.createElement("button");
        boostBtn.className = "boost-btn-admin";
        boostBtn.innerHTML = u.boosted ? "üîÑ –ü—Ä–æ–¥–ª–∏—Ç—å –±—É—Å—Ç" : "üöÄ –ë—É—Å—Ç –∞–Ω–∫–µ—Ç—ã";
        boostBtn.onclick = () => {
          showBoostModal(u);
        };
        actionsRow2.appendChild(boostBtn);

        // –ö–Ω–æ–ø–∫–∞ –ø–æ–¥–∞—Ä–∫–∞ —Å–≤–∞–π–ø–æ–≤
        const swipesBtn = document.createElement("button");
        swipesBtn.className = "swipes-btn-admin";
        swipesBtn.innerHTML = "üîÑ –ü–æ–¥–∞—Ä–∏—Ç—å —Å–≤–∞–π–ø—ã";
        swipesBtn.onclick = () => {
          showSwipesModal(u);
        };
        actionsRow2.appendChild(swipesBtn);

        // –ö–Ω–æ–ø–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
        const blockBtn = document.createElement("button");
        blockBtn.className = u.blocked ? "unblock-btn" : "block-btn";
        blockBtn.textContent = u.blocked ? "–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å" : "–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å";
        blockBtn.onclick = () => {
          u.blocked = !u.blocked;
          u.is_new = false;
          switchTab(currentTab);
          updateStats();
          
          alert(
            u.blocked
              ? "‚úÖ –ê–Ω–∫–µ—Ç–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ (–¥–µ–º–æ-—Ä–µ–∂–∏–º)"
              : "‚úÖ –ê–Ω–∫–µ—Ç–∞ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ (–¥–µ–º–æ-—Ä–µ–∂–∏–º)"
          );
        };
        actionsRow2.appendChild(blockBtn);

        actions.appendChild(actionsRow1);
        actions.appendChild(actionsRow2);
        li.appendChild(main);
        li.appendChild(actions);
        usersList.appendChild(li);
      });
    }

    // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –∂–∞–ª–æ–±
    function renderReports() {
      usersList.innerHTML = "";
      
      if (!allReports.length) {
        resultsInfo.textContent = "–ù–µ—Ç –∂–∞–ª–æ–± –Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏";
        return;
      }
      
      // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –¥–∞—Ç–µ (–Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É)
      const sortedReports = [...allReports].sort((a, b) => 
        new Date(b.createdAt) - new Date(a.createdAt)
      );
      
      const pendingCount = sortedReports.filter(r => r.status === 'pending').length;
      resultsInfo.textContent = `–ñ–∞–ª–æ–±—ã: ${sortedReports.length} —à—Ç. (${pendingCount} –Ω–æ–≤—ã—Ö)`;
      
      sortedReports.forEach((report) => {
        const li = document.createElement("li");
        
        // –ö–ª–∞—Å—Å—ã –¥–ª—è —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏ –ø–æ —Å—Ç–∞—Ç—É—Å—É
        const classes = ['user-item', 'report-item'];
        if (report.status === 'pending') classes.push('new');
        if (report.status === 'reviewing') classes.push('pending');
        if (report.status === 'resolved') classes.push('verified');
        if (report.status === 'rejected') classes.push('blocked');
        
        li.className = classes.join(' ');

        const main = document.createElement("div");
        main.className = "user-main";
        
        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∏–∫–æ–Ω–∫—É —Å—Ç–∞—Ç—É—Å–∞
        const statusIcon = {
          'pending': '‚ö†Ô∏è',
          'reviewing': 'üîç',
          'resolved': '‚úÖ',
          'rejected': '‚ùå'
        }[report.status];
        
        const statusText = {
          'pending': '–ù–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏',
          'reviewing': '–í –ø—Ä–æ—Ü–µ—Å—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏',
          'resolved': '–†–µ—à–µ–Ω–æ',
          'rejected': '–û—Ç–∫–ª–æ–Ω–µ–Ω–æ'
        }[report.status];
        
        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ü–≤–µ—Ç —Å—Ç–∞—Ç—É—Å–∞
        const statusColor = {
          'pending': 'var(--warning)',
          'reviewing': 'var(--info)',
          'resolved': '#10b981',
          'rejected': 'var(--danger)'
        }[report.status];
        
        const messageCount = report.chatMessages?.length || 0;
        const createdAt = new Date(report.createdAt);
        const timeAgo = getTimeAgo(createdAt);
        
        main.innerHTML = `
          <div class="user-name">
            ${statusIcon} –ñ–∞–ª–æ–±–∞ #${report.id}
            <span class="report-badge" style="background: ${statusColor + '20'}; color: ${statusColor};">
              ${statusText}
            </span>
          </div>
          <div class="user-meta">
            <span>üë§ –û—Ç: ${report.reporterName} (ID: ${report.reporterId})</span>
            <span>üéØ –ù–∞: ${report.reportedUserName} (ID: ${report.reportedUserId})</span>
            <span>üìù –ü—Ä–∏—á–∏–Ω–∞: ${report.reason}</span>
            <span>üí¨ –°–æ–æ–±—â–µ–Ω–∏–π: ${messageCount}</span>
            <span>üìÖ ${timeAgo}</span>
            ${report.adminResponse ? `<span>üìã –û—Ç–≤–µ—Ç: ${report.adminResponse.substring(0, 50)}...</span>` : ''}
          </div>
        `;

        const actions = document.createElement("div");
        actions.className = "user-actions";
        
        const actionsRow1 = document.createElement("div");
        actionsRow1.className = "user-actions-row";
        
        const actionsRow2 = document.createElement("div");
        actionsRow2.className = "user-actions-row";

        // –ö–Ω–æ–ø–∫–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–µ—Ç–∞–ª–µ–π
        const viewBtn = document.createElement("button");
        viewBtn.className = "report-details-btn";
        viewBtn.textContent = "üëÅÔ∏è –ü–æ–¥—Ä–æ–±–Ω–µ–µ";
        viewBtn.onclick = () => {
          showReportDetails(report);
        };
        actionsRow1.appendChild(viewBtn);
        
        // –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å—Ç–∞—Ç—É—Å–∞
        if (report.status === 'pending') {
          const reviewBtn = document.createElement("button");
          reviewBtn.className = "verify-btn";
          reviewBtn.textContent = "üîç –ù–∞—á–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É";
          reviewBtn.onclick = () => {
            startReviewReport(report.id);
          };
          actionsRow2.appendChild(reviewBtn);
        }
        
        if (report.status === 'reviewing') {
          const resolveBtn = document.createElement("button");
          resolveBtn.className = "verify-btn";
          resolveBtn.textContent = "‚úÖ –†–µ—à–∏—Ç—å";
          resolveBtn.onclick = () => {
            resolveReport(report.id);
          };
          actionsRow2.appendChild(resolveBtn);
          
          const rejectBtn = document.createElement("button");
          rejectBtn.className = "reject-btn";
          rejectBtn.textContent = "‚ùå –û—Ç–∫–ª–æ–Ω–∏—Ç—å";
          rejectBtn.onclick = () => {
            rejectReport(report.id);
          };
          actionsRow2.appendChild(rejectBtn);
        }
        
        if (report.status === 'resolved' || report.status === 'rejected') {
          const reopenBtn = document.createElement("button");
          reopenBtn.className = "link-btn";
          reopenBtn.textContent = "üîÑ –ü–µ—Ä–µ–æ—Ç–∫—Ä—ã—Ç—å";
          reopenBtn.onclick = () => {
            reopenReport(report.id);
          };
          actionsRow2.appendChild(reopenBtn);
        }
        
        // –ö–Ω–æ–ø–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        if (report.status !== 'rejected') {
          const blockBtn = document.createElement("button");
          blockBtn.className = "block-btn";
          blockBtn.textContent = "üö´ –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å";
          blockBtn.onclick = () => {
            blockReportedUser(report.reportedUserId);
          };
          actionsRow2.appendChild(blockBtn);
        }

        actions.appendChild(actionsRow1);
        actions.appendChild(actionsRow2);
        li.appendChild(main);
        li.appendChild(actions);
        usersList.appendChild(li);
      });
    }

    // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏
    function getTimeAgo(date) {
      const now = new Date();
      const diffMs = now - date;
      const diffMins = Math.floor(diffMs / 60000);
      const diffHours = Math.floor(diffMs / 3600000);
      const diffDays = Math.floor(diffMs / 86400000);
      
      if (diffMins < 60) {
        return `${diffMins} –º–∏–Ω. –Ω–∞–∑–∞–¥`;
      } else if (diffHours < 24) {
        return `${diffHours} —á. –Ω–∞–∑–∞–¥`;
      } else {
        return `${diffDays} –¥–Ω. –Ω–∞–∑–∞–¥`;
      }
    }

    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
    function switchTab(tabName) {
      currentTab = tabName;
      
      // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
      tabButtons.forEach(btn => {
        btn.classList.toggle('active', btn.dataset.tab === tabName);
      });
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º –ø–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä—ã
      if (tabName === 'search') {
        searchRow.classList.remove('hidden');
        filtersRow.classList.remove('hidden');
      } else {
        searchRow.classList.add('hidden');
        filtersRow.classList.add('hidden');
      }
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º –±–∞–Ω–Ω–µ—Ä—ã
      Object.keys(sectionBanners).forEach(key => {
        if (key === tabName) {
          sectionBanners[key]?.classList.remove('hidden');
        } else {
          sectionBanners[key]?.classList.add('hidden');
        }
      });
      
      // –§–∏–ª—å—Ç—Ä—É–µ–º –∏ —Ä–µ–Ω–¥–µ—Ä–∏–º
      if (tabName === 'reports') {
        renderReports();
      } else if (tabName === 'bonuses') {
        renderBonusUsers();
      } else {
        const users = filterUsersByTab();
        renderUsers(users);
      }
    }

    // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
    function showNotification(message) {
      // –í –¥–µ–º–æ-—Ä–µ–∂–∏–º–µ –ø—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º alert
      alert(message);
    }

    // –õ–æ–≥–∏–Ω
    function handleLogin() {
      const value = passwordInput.value;
      if (value === ADMIN_PASSWORD) {
        loginError.textContent = "";
        loginCard.classList.add("hidden");
        adminCard.classList.remove("hidden");
        localStorage.setItem("siamatch_admin_logged_in", "1");
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
        updateStats();
        switchTab("all");
      } else {
        loginError.textContent = "–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å.";
      }
    }

    // –õ–æ–≥–∞—É—Ç
    function handleLogout() {
      localStorage.removeItem("siamatch_admin_logged_in");
      adminCard.classList.add("hidden");
      loginCard.classList.remove("hidden");
      passwordInput.value = "";
      currentTab = "all";
      verificationModal.classList.add('hidden');
      boostModal.classList.add('hidden');
      swipesModal.classList.add('hidden');
      bonusModal.classList.add('hidden');
      bonusHistoryModal.classList.add('hidden');
      reportDetailsModal.classList.add('hidden');
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    function initAdminPanel() {
      console.log('üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏...');
      
      // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–µ–º–æ-–¥–∞–Ω–Ω—ã—Ö
      allUsers = generateDemoUsers(50);
      console.log('‚úÖ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ –¥–µ–º–æ-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:', allUsers.length);
      
      // –ó–∞–≥—Ä—É–∑–∫–∞ –∂–∞–ª–æ–±
      loadReports();
      console.log('‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ –∂–∞–ª–æ–±:', allReports.length);
      
      // –ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ –±–æ–Ω—É—Å–æ–≤
      loadBonuses();
      console.log('‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ –±–æ–Ω—É—Å–æ–≤:', allBonuses.length);
      
      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –ª–æ–≥–∏–Ω–∞
      loginBtn.onclick = handleLogin;
      
      passwordInput.addEventListener("keydown", (e) => {
        if (e.key === "Enter") handleLogin();
      });

      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ª–æ–≥–∞—É—Ç–∞
      logoutBtn.onclick = handleLogout;

      // –ó–∞–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
      closeModalBtn.onclick = () => {
        verificationModal.classList.add('hidden');
      };

      closeBoostModalBtn.onclick = () => {
        boostModal.classList.add('hidden');
        currentUserForBoost = null;
      };

      closeSwipesModalBtn.onclick = () => {
        swipesModal.classList.add('hidden');
        currentUserForSwipes = null;
      };

      closeBonusModalBtn.onclick = () => {
        bonusModal.classList.add('hidden');
        currentUserForBonus = null;
      };

      closeBonusHistoryBtn.onclick = () => {
        bonusHistoryModal.classList.add('hidden');
        currentUserForBonusHistory = null;
      };

      closeReportDetailsBtn.onclick = () => {
        reportDetailsModal.classList.add('hidden');
        currentReportForDetails = null;
      };

      // –ü—Ä–∏–º–µ–Ω–∏—Ç—å –±—É—Å—Ç
      applyBoostBtn.onclick = applyBoost;

      // –ü–æ–¥–∞—Ä–∏—Ç—å —Å–≤–∞–π–ø—ã
      applySwipesBtn.onclick = applySwipes;

      // –ù–ê–ß–ò–°–õ–ò–¢–¨ –ë–û–ù–£–°
      applyBonusBtn.onclick = applyBonus;

      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞ –±–æ–Ω—É—Å–∞
      bonusTypeSelect.addEventListener('change', function() {
        customBonusAmountDiv.classList.add('hidden');
        customBoostHoursDiv.classList.add('hidden');
        
        if (this.value === 'custom_swipes') {
          customBonusAmountDiv.classList.remove('hidden');
        } else if (this.value === 'custom_boost') {
          customBoostHoursDiv.classList.remove('hidden');
        }
      });

      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –±—É—Å—Ç–∞
      boostDurationSelect.addEventListener('change', function() {
        if (this.value === 'custom') {
          customBoostDuration.classList.remove('hidden');
        } else {
          customBoostDuration.classList.add('hidden');
        }
      });

      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–≤–∞–π–ø–æ–≤
      document.querySelectorAll('.swipe-amount-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          document.querySelectorAll('.swipe-amount-btn').forEach(b => b.classList.remove('active'));
          this.classList.add('active');
          customSwipesInput.value = this.dataset.amount;
        });
      });

      // –ü–æ–∏—Å–∫
      searchBtn.onclick = () => {
        switchTab("search");
      };

      searchInput.addEventListener("keydown", (e) => {
        if (e.key === "Enter") switchTab("search");
      });

      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤
      const filters = [filterGender, filterCity, filterVerification, filterAgeMin, filterAgeMax];
      filters.forEach(filter => {
        filter.addEventListener("change", () => {
          if (currentTab === 'search') {
            const users = filterUsersByTab();
            renderUsers(users);
          }
        });
      });

      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Ç–∞–±–æ–≤
      tabButtons.forEach(btn => {
        btn.addEventListener("click", () => {
          switchTab(btn.dataset.tab);
        });
      });

      // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –∏—Ö
      verificationModal.onclick = (e) => {
        if (e.target === verificationModal) {
          verificationModal.classList.add('hidden');
        }
      };

      boostModal.onclick = (e) => {
        if (e.target === boostModal) {
          boostModal.classList.add('hidden');
          currentUserForBoost = null;
        }
      };

      swipesModal.onclick = (e) => {
        if (e.target === swipesModal) {
          swipesModal.classList.add('hidden');
          currentUserForSwipes = null;
        }
      };

      bonusModal.onclick = (e) => {
        if (e.target === bonusModal) {
          bonusModal.classList.add('hidden');
          currentUserForBonus = null;
        }
      };

      bonusHistoryModal.onclick = (e) => {
        if (e.target === bonusHistoryModal) {
          bonusHistoryModal.classList.add('hidden');
          currentUserForBonusHistory = null;
        }
      };

      reportDetailsModal.onclick = (e) => {
        if (e.target === reportDetailsModal) {
          reportDetailsModal.classList.add('hidden');
          currentReportForDetails = null;
        }
      };

      // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ-–ª–æ–≥–∏–Ω–∞
      if (localStorage.getItem("siamatch_admin_logged_in") === "1") {
        console.log('üîë –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ª–æ–≥–∏–Ω...');
        loginCard.classList.add("hidden");
        adminCard.classList.remove("hidden");
        updateStats();
        switchTab("all");
      } else {
        console.log('üîí –¢—Ä–µ–±—É–µ—Ç—Å—è –ª–æ–≥–∏–Ω');
      }
      
      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–∫—Ç–∏–≤–Ω–æ–π –∫–Ω–æ–ø–∫–∏ —Å–≤–∞–π–ø–æ–≤
      setTimeout(() => {
        const defaultSwipeBtn = document.querySelector('.swipe-amount-btn[data-amount="50"]');
        if (defaultSwipeBtn) {
          defaultSwipeBtn.classList.add('active');
        }
      }, 100);
      
      console.log('‚úÖ –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞');
    }

    // –ó–∞–ø—É—Å–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    document.addEventListener('DOMContentLoaded', initAdminPanel);
  </script>
</body>
</html>
